# 动量法

（小批量）随机梯度修改了梯度下降中计算梯度的方式，它使用更少的样本来计算梯度。这一节我们将介绍动量法，它改变了如何使用梯度来更新自变量。在[“梯度下降和随机梯度下降”](./gd-sgd.md)一节中我们介绍了目标函数有关自变量的梯度代表了目标函数在当前点下降最快的方向。在每次迭代中，梯度下降算法根据自变量当前所在位置，沿着当前位置的梯度更新自变量。因此梯度下降也叫做最陡下降（steepest descent）。但自变量的迭代方向仅仅取决于自变量当前位置，这可能会带来一些问题。

## 梯度下降的问题

让我们考虑一个输入和输出分别为二维向量$\boldsymbol{x} = [x_1, x_2]^\top$和标量的目标函数$f(\boldsymbol{x})=0.1x_1^2+2x_2$。跟[“梯度下降和随机梯度下降”](./gd-sgd.md)一节中不同的在于我们将$x_1^2$系数从$1$减小到了$0.1$。然后观察梯度下降优化该目标函数的迭代过程。先导入实验所需的包或模块。

```{.python .input  n=1}
import sys
#sys.path.insert(0, '..')

%matplotlib inline
import gluonbook as gb
from mxnet import nd
```

```{.json .output n=1}
[
 {
  "name": "stderr",
  "output_type": "stream",
  "text": "/home/zli/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\n  from ._conv import register_converters as _register_converters\n"
 }
]
```

下面实现基于这个目标函数的梯度下降，并演示使用学习率为$0.4$时自变量的迭代轨迹。

```{.python .input  n=2}
eta = 0.4
f_2d = lambda x1, x2: 0.1 * x1 ** 2 + 2 * x2 ** 2
gd_2d = lambda x1, x2, s1, s2: (x1 - eta * 0.2 * x1, x2 - eta * 4 * x2, 0, 0)
gb.show_trace_2d(f_2d, gb.train_2d(gd_2d))
```

```{.json .output n=2}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "epoch 20, x1 -0.943467, x2 -0.000073\n"
 },
 {
  "data": {
   "image/svg+xml": "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n  \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Created with matplotlib (http://matplotlib.org/) -->\n<svg height=\"184.15625pt\" version=\"1.1\" viewBox=\"0 0 248.620313 184.15625\" width=\"248.620313pt\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n <defs>\n  <style type=\"text/css\">\n*{stroke-linecap:butt;stroke-linejoin:round;}\n  </style>\n </defs>\n <g id=\"figure_1\">\n  <g id=\"patch_1\">\n   <path d=\"M 0 184.15625 \nL 248.620313 184.15625 \nL 248.620313 -0 \nL 0 -0 \nz\n\" style=\"fill:none;\"/>\n  </g>\n  <g id=\"axes_1\">\n   <g id=\"patch_2\">\n    <path d=\"M 42.620312 146.6 \nL 237.920313 146.6 \nL 237.920313 10.7 \nL 42.620312 10.7 \nz\n\" style=\"fill:#ffffff;\"/>\n   </g>\n   <g id=\"matplotlib.axis_1\">\n    <g id=\"xtick_1\">\n     <g id=\"line2d_1\">\n      <defs>\n       <path d=\"M 0 0 \nL 0 3.5 \n\" id=\"m83e81a557d\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"88.39375\" xlink:href=\"#m83e81a557d\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_1\">\n      <!-- \u22124 -->\n      <defs>\n       <path d=\"M 10.59375 35.5 \nL 73.1875 35.5 \nL 73.1875 27.203125 \nL 10.59375 27.203125 \nz\n\" id=\"DejaVuSans-2212\"/>\n       <path d=\"M 37.796875 64.3125 \nL 12.890625 25.390625 \nL 37.796875 25.390625 \nz\nM 35.203125 72.90625 \nL 47.609375 72.90625 \nL 47.609375 25.390625 \nL 58.015625 25.390625 \nL 58.015625 17.1875 \nL 47.609375 17.1875 \nL 47.609375 0 \nL 37.796875 0 \nL 37.796875 17.1875 \nL 4.890625 17.1875 \nL 4.890625 26.703125 \nz\n\" id=\"DejaVuSans-34\"/>\n      </defs>\n      <g transform=\"translate(81.022656 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-34\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_2\">\n     <g id=\"line2d_2\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"149.425\" xlink:href=\"#m83e81a557d\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_2\">\n      <!-- \u22122 -->\n      <defs>\n       <path d=\"M 19.1875 8.296875 \nL 53.609375 8.296875 \nL 53.609375 0 \nL 7.328125 0 \nL 7.328125 8.296875 \nQ 12.9375 14.109375 22.625 23.890625 \nQ 32.328125 33.6875 34.8125 36.53125 \nQ 39.546875 41.84375 41.421875 45.53125 \nQ 43.3125 49.21875 43.3125 52.78125 \nQ 43.3125 58.59375 39.234375 62.25 \nQ 35.15625 65.921875 28.609375 65.921875 \nQ 23.96875 65.921875 18.8125 64.3125 \nQ 13.671875 62.703125 7.8125 59.421875 \nL 7.8125 69.390625 \nQ 13.765625 71.78125 18.9375 73 \nQ 24.125 74.21875 28.421875 74.21875 \nQ 39.75 74.21875 46.484375 68.546875 \nQ 53.21875 62.890625 53.21875 53.421875 \nQ 53.21875 48.921875 51.53125 44.890625 \nQ 49.859375 40.875 45.40625 35.40625 \nQ 44.1875 33.984375 37.640625 27.21875 \nQ 31.109375 20.453125 19.1875 8.296875 \nz\n\" id=\"DejaVuSans-32\"/>\n      </defs>\n      <g transform=\"translate(142.053906 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-32\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_3\">\n     <g id=\"line2d_3\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"210.45625\" xlink:href=\"#m83e81a557d\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_3\">\n      <!-- 0 -->\n      <defs>\n       <path d=\"M 31.78125 66.40625 \nQ 24.171875 66.40625 20.328125 58.90625 \nQ 16.5 51.421875 16.5 36.375 \nQ 16.5 21.390625 20.328125 13.890625 \nQ 24.171875 6.390625 31.78125 6.390625 \nQ 39.453125 6.390625 43.28125 13.890625 \nQ 47.125 21.390625 47.125 36.375 \nQ 47.125 51.421875 43.28125 58.90625 \nQ 39.453125 66.40625 31.78125 66.40625 \nz\nM 31.78125 74.21875 \nQ 44.046875 74.21875 50.515625 64.515625 \nQ 56.984375 54.828125 56.984375 36.375 \nQ 56.984375 17.96875 50.515625 8.265625 \nQ 44.046875 -1.421875 31.78125 -1.421875 \nQ 19.53125 -1.421875 13.0625 8.265625 \nQ 6.59375 17.96875 6.59375 36.375 \nQ 6.59375 54.828125 13.0625 64.515625 \nQ 19.53125 74.21875 31.78125 74.21875 \nz\n\" id=\"DejaVuSans-30\"/>\n      </defs>\n      <g transform=\"translate(207.275 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_4\">\n     <!-- x1 -->\n     <defs>\n      <path d=\"M 54.890625 54.6875 \nL 35.109375 28.078125 \nL 55.90625 0 \nL 45.3125 0 \nL 29.390625 21.484375 \nL 13.484375 0 \nL 2.875 0 \nL 24.125 28.609375 \nL 4.6875 54.6875 \nL 15.28125 54.6875 \nL 29.78125 35.203125 \nL 44.28125 54.6875 \nz\n\" id=\"DejaVuSans-78\"/>\n      <path d=\"M 12.40625 8.296875 \nL 28.515625 8.296875 \nL 28.515625 63.921875 \nL 10.984375 60.40625 \nL 10.984375 69.390625 \nL 28.421875 72.90625 \nL 38.28125 72.90625 \nL 38.28125 8.296875 \nL 54.390625 8.296875 \nL 54.390625 0 \nL 12.40625 0 \nz\n\" id=\"DejaVuSans-31\"/>\n     </defs>\n     <g transform=\"translate(134.129687 174.876562)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-78\"/>\n      <use x=\"59.179688\" xlink:href=\"#DejaVuSans-31\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"matplotlib.axis_2\">\n    <g id=\"ytick_1\">\n     <g id=\"line2d_4\">\n      <defs>\n       <path d=\"M 0 0 \nL -3.5 0 \n\" id=\"m81c6d8b4b0\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#m81c6d8b4b0\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_5\">\n      <!-- \u22123 -->\n      <defs>\n       <path d=\"M 40.578125 39.3125 \nQ 47.65625 37.796875 51.625 33 \nQ 55.609375 28.21875 55.609375 21.1875 \nQ 55.609375 10.40625 48.1875 4.484375 \nQ 40.765625 -1.421875 27.09375 -1.421875 \nQ 22.515625 -1.421875 17.65625 -0.515625 \nQ 12.796875 0.390625 7.625 2.203125 \nL 7.625 11.71875 \nQ 11.71875 9.328125 16.59375 8.109375 \nQ 21.484375 6.890625 26.8125 6.890625 \nQ 36.078125 6.890625 40.9375 10.546875 \nQ 45.796875 14.203125 45.796875 21.1875 \nQ 45.796875 27.640625 41.28125 31.265625 \nQ 36.765625 34.90625 28.71875 34.90625 \nL 20.21875 34.90625 \nL 20.21875 43.015625 \nL 29.109375 43.015625 \nQ 36.375 43.015625 40.234375 45.921875 \nQ 44.09375 48.828125 44.09375 54.296875 \nQ 44.09375 59.90625 40.109375 62.90625 \nQ 36.140625 65.921875 28.71875 65.921875 \nQ 24.65625 65.921875 20.015625 65.03125 \nQ 15.375 64.15625 9.8125 62.3125 \nL 9.8125 71.09375 \nQ 15.4375 72.65625 20.34375 73.4375 \nQ 25.25 74.21875 29.59375 74.21875 \nQ 40.828125 74.21875 47.359375 69.109375 \nQ 53.90625 64.015625 53.90625 55.328125 \nQ 53.90625 49.265625 50.4375 45.09375 \nQ 46.96875 40.921875 40.578125 39.3125 \nz\n\" id=\"DejaVuSans-33\"/>\n      </defs>\n      <g transform=\"translate(20.878125 150.399219)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-33\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_2\">\n     <g id=\"line2d_5\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#m81c6d8b4b0\" y=\"119.952941\"/>\n      </g>\n     </g>\n     <g id=\"text_6\">\n      <!-- \u22122 -->\n      <g transform=\"translate(20.878125 123.75216)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-32\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_3\">\n     <g id=\"line2d_6\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#m81c6d8b4b0\" y=\"93.305882\"/>\n      </g>\n     </g>\n     <g id=\"text_7\">\n      <!-- \u22121 -->\n      <g transform=\"translate(20.878125 97.105101)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-31\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_4\">\n     <g id=\"line2d_7\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#m81c6d8b4b0\" y=\"66.658824\"/>\n      </g>\n     </g>\n     <g id=\"text_8\">\n      <!-- 0 -->\n      <g transform=\"translate(29.257812 70.458042)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_5\">\n     <g id=\"line2d_8\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#m81c6d8b4b0\" y=\"40.011765\"/>\n      </g>\n     </g>\n     <g id=\"text_9\">\n      <!-- 1 -->\n      <g transform=\"translate(29.257812 43.810983)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-31\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_6\">\n     <g id=\"line2d_9\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#m81c6d8b4b0\" y=\"13.364706\"/>\n      </g>\n     </g>\n     <g id=\"text_10\">\n      <!-- 2 -->\n      <g transform=\"translate(29.257812 17.163925)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-32\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_11\">\n     <!-- x2 -->\n     <g transform=\"translate(14.798437 84.790625)rotate(-90)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-78\"/>\n      <use x=\"59.179688\" xlink:href=\"#DejaVuSans-32\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"LineCollection_1\">\n    <path clip-path=\"url(#p17edc06252)\" d=\"M 237.920313 98.843141 \nL 222.6625 99.189553 \nL 207.404688 99.269494 \nL 192.146875 99.082965 \nL 176.889063 98.629501 \nL 164.682813 98.027046 \nL 152.476563 97.23922 \nL 140.270313 96.266023 \nL 131.115625 95.361513 \nL 118.909375 93.940336 \nL 109.754688 92.68178 \nL 97.100875 90.641176 \nL 85.342188 88.282128 \nL 82.290625 87.585647 \nL 73.135938 85.26052 \nL 63.98125 82.356364 \nL 57.878125 79.982353 \nL 52.486044 77.317647 \nL 48.409725 74.652941 \nL 45.559891 71.988235 \nL 43.880132 69.323529 \nL 43.320212 66.658824 \nL 43.880132 63.994118 \nL 45.671875 61.222824 \nL 48.723438 58.455336 \nL 52.486044 56 \nL 57.878125 53.335294 \nL 64.752171 50.670588 \nL 73.307374 48.005882 \nL 83.908321 45.341176 \nL 94.496875 43.178062 \nL 100.6 42.08743 \nL 113.96875 40.011765 \nL 125.0125 38.641345 \nL 137.21875 37.323887 \nL 149.425 36.304348 \nL 161.63125 35.470179 \nL 173.8375 34.821381 \nL 186.04375 34.383906 \nL 201.301563 34.090788 \nL 216.559375 34.064141 \nL 231.817188 34.303965 \nL 237.920313 34.474506 \nL 237.920313 34.474506 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_2\">\n    <path clip-path=\"url(#p17edc06252)\" d=\"M 237.920313 112.487958 \nL 234.86875 112.552672 \nL 231.817188 112.609773 \nL 228.765625 112.659261 \nL 225.714063 112.701134 \nL 222.6625 112.735395 \nL 219.610938 112.762042 \nL 216.559375 112.781076 \nL 213.507813 112.792496 \nL 210.45625 112.796303 \nL 207.404688 112.792496 \nL 204.353125 112.781076 \nL 201.301563 112.762042 \nL 198.25 112.735395 \nL 195.198438 112.701134 \nL 192.146875 112.659261 \nL 189.095313 112.609773 \nL 186.04375 112.552672 \nL 182.992188 112.487958 \nL 179.940625 112.41563 \nL 176.889063 112.335689 \nL 173.8375 112.248134 \nL 170.785938 112.152966 \nL 167.734375 112.050185 \nL 165.208944 111.958824 \nL 164.682813 111.938636 \nL 161.63125 111.813476 \nL 158.579688 111.680241 \nL 155.528125 111.53893 \nL 152.476563 111.389545 \nL 149.425 111.232086 \nL 146.373438 111.066551 \nL 143.321875 110.892941 \nL 140.270313 110.711257 \nL 137.21875 110.521497 \nL 134.167188 110.323663 \nL 131.115625 110.117754 \nL 128.064063 109.90377 \nL 125.0125 109.681711 \nL 121.960938 109.451578 \nL 119.943803 109.294118 \nL 118.909375 109.208159 \nL 115.857813 108.945987 \nL 112.80625 108.675218 \nL 109.754688 108.395854 \nL 106.703125 108.107894 \nL 103.651563 107.811338 \nL 100.6 107.506186 \nL 97.548438 107.192438 \nL 94.496875 106.870095 \nL 92.277557 106.629412 \nL 91.445313 106.532931 \nL 88.39375 106.16998 \nL 85.342188 105.79784 \nL 82.290625 105.416511 \nL 79.239063 105.025994 \nL 76.1875 104.626288 \nL 73.135938 104.217394 \nL 71.291587 103.964706 \nL 70.084375 103.787059 \nL 67.032813 103.328137 \nL 63.98125 102.859346 \nL 60.929688 102.380686 \nL 57.878125 101.892157 \nL 54.826563 101.393758 \nL 54.263653 101.3 \nL 51.775 100.852329 \nL 48.723438 100.292741 \nL 45.671875 99.722494 \nL 42.620313 99.141588 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#p17edc06252)\" d=\"M 42.620313 34.176059 \nL 45.671875 33.595153 \nL 48.723438 33.024906 \nL 51.775 32.465318 \nL 54.263653 32.017647 \nL 54.826563 31.923889 \nL 57.878125 31.42549 \nL 60.929688 30.936961 \nL 63.98125 30.458301 \nL 67.032813 29.98951 \nL 70.084375 29.530588 \nL 71.291587 29.352941 \nL 73.135938 29.100254 \nL 76.1875 28.691359 \nL 79.239063 28.291653 \nL 82.290625 27.901136 \nL 85.342188 27.519807 \nL 88.39375 27.147667 \nL 91.445313 26.784716 \nL 92.277557 26.688235 \nL 94.496875 26.447552 \nL 97.548438 26.125209 \nL 100.6 25.811461 \nL 103.651563 25.506309 \nL 106.703125 25.209753 \nL 109.754688 24.921793 \nL 112.80625 24.642429 \nL 115.857813 24.37166 \nL 118.909375 24.109488 \nL 119.943803 24.023529 \nL 121.960938 23.86607 \nL 125.0125 23.635936 \nL 128.064063 23.413877 \nL 131.115625 23.199893 \nL 134.167188 22.993984 \nL 137.21875 22.79615 \nL 140.270313 22.60639 \nL 143.321875 22.424706 \nL 146.373438 22.251096 \nL 149.425 22.085561 \nL 152.476563 21.928102 \nL 155.528125 21.778717 \nL 158.579688 21.637406 \nL 161.63125 21.504171 \nL 164.682813 21.379011 \nL 165.208944 21.358824 \nL 167.734375 21.267462 \nL 170.785938 21.164681 \nL 173.8375 21.069513 \nL 176.889063 20.981958 \nL 179.940625 20.902017 \nL 182.992188 20.829689 \nL 186.04375 20.764975 \nL 189.095313 20.707874 \nL 192.146875 20.658387 \nL 195.198438 20.616513 \nL 198.25 20.582252 \nL 201.301563 20.555605 \nL 204.353125 20.536571 \nL 207.404688 20.525151 \nL 210.45625 20.521345 \nL 213.507813 20.525151 \nL 216.559375 20.536571 \nL 219.610938 20.555605 \nL 222.6625 20.582252 \nL 225.714063 20.616513 \nL 228.765625 20.658387 \nL 231.817188 20.707874 \nL 234.86875 20.764975 \nL 237.920313 20.829689 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_3\">\n    <path clip-path=\"url(#p17edc06252)\" d=\"M 237.920313 122.924398 \nL 234.86875 122.977073 \nL 231.817188 123.02355 \nL 228.765625 123.06383 \nL 225.714063 123.097914 \nL 222.6625 123.1258 \nL 219.610938 123.14749 \nL 216.559375 123.162982 \nL 213.507813 123.172278 \nL 210.45625 123.175376 \nL 207.404688 123.172278 \nL 204.353125 123.162982 \nL 201.301563 123.14749 \nL 198.25 123.1258 \nL 195.198438 123.097914 \nL 192.146875 123.06383 \nL 189.095313 123.02355 \nL 186.04375 122.977073 \nL 182.992188 122.924398 \nL 179.940625 122.865527 \nL 176.889063 122.800458 \nL 173.8375 122.729193 \nL 170.785938 122.651731 \nL 169.542708 122.617647 \nL 167.734375 122.565653 \nL 164.682813 122.471413 \nL 161.63125 122.370674 \nL 158.579688 122.263436 \nL 155.528125 122.149699 \nL 152.476563 122.029462 \nL 149.425 121.902726 \nL 146.373438 121.769491 \nL 143.321875 121.629756 \nL 140.270313 121.483522 \nL 137.21875 121.330789 \nL 134.167188 121.171557 \nL 131.115625 121.005825 \nL 128.064063 120.833594 \nL 125.0125 120.654864 \nL 121.960938 120.469634 \nL 118.909375 120.277905 \nL 115.857813 120.079677 \nL 113.96875 119.952941 \nL 112.80625 119.87095 \nL 109.754688 119.648891 \nL 106.703125 119.42 \nL 103.651563 119.184276 \nL 100.6 118.941719 \nL 97.548438 118.69233 \nL 94.496875 118.436109 \nL 91.445313 118.173054 \nL 88.39375 117.903167 \nL 85.342188 117.626448 \nL 82.290625 117.342896 \nL 81.716213 117.288235 \nL 79.239063 117.039769 \nL 76.1875 116.726486 \nL 73.135938 116.406002 \nL 70.084375 116.078315 \nL 67.032813 115.743426 \nL 63.98125 115.401335 \nL 60.929688 115.052043 \nL 57.878125 114.695548 \nL 57.273855 114.623529 \nL 54.826563 114.315185 \nL 51.775 113.923092 \nL 48.723438 113.523387 \nL 45.671875 113.116067 \nL 42.620313 112.701134 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#p17edc06252)\" d=\"M 42.620313 20.616513 \nL 45.671875 20.20158 \nL 48.723438 19.794261 \nL 51.775 19.394555 \nL 54.826563 19.002462 \nL 57.273855 18.694118 \nL 57.878125 18.622099 \nL 60.929688 18.265604 \nL 63.98125 17.916312 \nL 67.032813 17.574221 \nL 70.084375 17.239332 \nL 73.135938 16.911645 \nL 76.1875 16.591161 \nL 79.239063 16.277878 \nL 81.716213 16.029412 \nL 82.290625 15.974751 \nL 85.342188 15.691199 \nL 88.39375 15.41448 \nL 91.445313 15.144593 \nL 94.496875 14.881538 \nL 97.548438 14.625317 \nL 100.6 14.375928 \nL 103.651563 14.133371 \nL 106.703125 13.897647 \nL 109.754688 13.668756 \nL 112.80625 13.446697 \nL 113.96875 13.364706 \nL 115.857813 13.23797 \nL 118.909375 13.039742 \nL 121.960938 12.848013 \nL 125.0125 12.662783 \nL 128.064063 12.484053 \nL 131.115625 12.311822 \nL 134.167188 12.14609 \nL 137.21875 11.986858 \nL 140.270313 11.834125 \nL 143.321875 11.687891 \nL 146.373438 11.548156 \nL 149.425 11.414921 \nL 152.476563 11.288185 \nL 155.528125 11.167948 \nL 158.579688 11.054211 \nL 161.63125 10.946973 \nL 164.682813 10.846234 \nL 167.734375 10.751994 \nL 169.542708 10.7 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_4\">\n    <path clip-path=\"url(#p17edc06252)\" d=\"M 237.920313 131.696681 \nL 234.86875 131.742905 \nL 231.817188 131.783691 \nL 228.765625 131.81904 \nL 225.714063 131.84895 \nL 222.6625 131.873421 \nL 219.610938 131.892455 \nL 216.559375 131.90605 \nL 213.507813 131.914208 \nL 210.45625 131.916927 \nL 207.404688 131.914208 \nL 204.353125 131.90605 \nL 201.301563 131.892455 \nL 198.25 131.873421 \nL 195.198438 131.84895 \nL 192.146875 131.81904 \nL 189.095313 131.783691 \nL 186.04375 131.742905 \nL 182.992188 131.696681 \nL 179.940625 131.645018 \nL 176.889063 131.587917 \nL 173.8375 131.525378 \nL 170.785938 131.457401 \nL 167.734375 131.383986 \nL 164.682813 131.305132 \nL 161.63125 131.22084 \nL 158.579688 131.13111 \nL 155.528125 131.035942 \nL 152.476563 130.935336 \nL 149.425 130.829292 \nL 146.373438 130.717809 \nL 143.605741 130.611765 \nL 143.321875 130.600426 \nL 140.270313 130.47286 \nL 137.21875 130.339625 \nL 134.167188 130.20072 \nL 131.115625 130.056145 \nL 128.064063 129.905901 \nL 125.0125 129.749987 \nL 121.960938 129.588404 \nL 118.909375 129.421151 \nL 115.857813 129.248229 \nL 112.80625 129.069637 \nL 109.754688 128.885375 \nL 106.703125 128.695444 \nL 103.651563 128.499844 \nL 100.6 128.298573 \nL 97.548438 128.091633 \nL 95.473375 127.947059 \nL 94.496875 127.876 \nL 91.445313 127.64802 \nL 88.39375 127.414118 \nL 85.342188 127.174294 \nL 82.290625 126.928549 \nL 79.239063 126.676882 \nL 76.1875 126.419294 \nL 73.135938 126.155784 \nL 70.084375 125.886353 \nL 67.032813 125.611 \nL 63.98125 125.329725 \nL 63.477899 125.282353 \nL 60.929688 125.031375 \nL 57.878125 124.724624 \nL 54.826563 124.411676 \nL 51.775 124.092531 \nL 48.723438 123.767189 \nL 45.671875 123.43565 \nL 42.620313 123.097914 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_5\">\n    <path clip-path=\"url(#p17edc06252)\" d=\"M 237.920313 139.427096 \nL 234.86875 139.468278 \nL 231.817188 139.504615 \nL 228.765625 139.536107 \nL 225.714063 139.562754 \nL 222.6625 139.584556 \nL 219.610938 139.601513 \nL 216.559375 139.613626 \nL 213.507813 139.620893 \nL 210.45625 139.623316 \nL 207.404688 139.620893 \nL 204.353125 139.613626 \nL 201.301563 139.601513 \nL 198.25 139.584556 \nL 195.198438 139.562754 \nL 192.146875 139.536107 \nL 189.095313 139.504615 \nL 186.04375 139.468278 \nL 182.992188 139.427096 \nL 179.940625 139.38107 \nL 176.889063 139.330198 \nL 173.8375 139.274481 \nL 170.785938 139.21392 \nL 167.734375 139.148513 \nL 164.682813 139.078262 \nL 161.63125 139.003166 \nL 158.579688 138.923225 \nL 155.528125 138.838439 \nL 152.476563 138.748807 \nL 149.425 138.654332 \nL 147.936433 138.605882 \nL 146.373438 138.553091 \nL 143.321875 138.444994 \nL 140.270313 138.33187 \nL 137.21875 138.213718 \nL 134.167188 138.090538 \nL 131.115625 137.962331 \nL 128.064063 137.829095 \nL 125.0125 137.690832 \nL 121.960938 137.547542 \nL 118.909375 137.399223 \nL 115.857813 137.245877 \nL 112.80625 137.087503 \nL 109.754688 136.924101 \nL 106.703125 136.755671 \nL 103.651563 136.582214 \nL 100.6 136.403729 \nL 97.548438 136.220216 \nL 94.496875 136.031676 \nL 93.07017 135.941176 \nL 91.445313 135.834066 \nL 88.39375 135.627682 \nL 85.342188 135.416073 \nL 82.290625 135.199239 \nL 79.239063 134.97718 \nL 76.1875 134.749896 \nL 73.135938 134.517388 \nL 70.084375 134.279654 \nL 67.032813 134.036696 \nL 63.98125 133.788512 \nL 60.929688 133.535104 \nL 57.878125 133.276471 \nL 57.878125 133.276471 \nL 54.826563 133.001843 \nL 51.775 132.721777 \nL 48.723438 132.436273 \nL 45.671875 132.14533 \nL 42.620313 131.84895 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_6\">\n    <path clip-path=\"url(#p17edc06252)\" d=\"M 210.45625 146.6 \nL 207.404688 146.597742 \nL 204.353125 146.590967 \nL 201.301563 146.579676 \nL 198.25 146.563868 \nL 195.198438 146.543544 \nL 192.146875 146.518704 \nL 189.095313 146.489347 \nL 186.04375 146.455474 \nL 182.992188 146.417084 \nL 179.940625 146.374177 \nL 176.889063 146.326755 \nL 173.8375 146.274816 \nL 170.785938 146.21836 \nL 167.734375 146.157388 \nL 164.682813 146.091899 \nL 161.63125 146.021894 \nL 158.579688 145.947373 \nL 155.528125 145.868335 \nL 152.476563 145.784781 \nL 149.425 145.69671 \nL 146.373438 145.604123 \nL 143.321875 145.507019 \nL 140.270313 145.405399 \nL 137.21875 145.299262 \nL 134.167188 145.188609 \nL 131.115625 145.07344 \nL 128.064063 144.953754 \nL 125.0125 144.829551 \nL 121.960938 144.700833 \nL 118.909375 144.567597 \nL 115.857813 144.429845 \nL 112.80625 144.287577 \nL 109.754688 144.140793 \nL 106.703125 143.989492 \nL 105.641712 143.935294 \nL 103.651563 143.830108 \nL 100.6 143.664149 \nL 97.548438 143.493514 \nL 94.496875 143.318204 \nL 91.445313 143.13822 \nL 88.39375 142.95356 \nL 85.342188 142.764226 \nL 82.290625 142.570217 \nL 79.239063 142.371533 \nL 76.1875 142.168173 \nL 73.135938 141.960139 \nL 70.084375 141.74743 \nL 67.032813 141.530046 \nL 63.98125 141.307988 \nL 63.477899 141.270588 \nL 60.929688 141.074369 \nL 57.878125 140.834545 \nL 54.826563 140.589877 \nL 51.775 140.340364 \nL 48.723438 140.086005 \nL 45.671875 139.826802 \nL 42.620313 139.562754 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#p17edc06252)\" d=\"M 237.920313 146.417084 \nL 234.86875 146.455474 \nL 231.817188 146.489347 \nL 228.765625 146.518704 \nL 225.714063 146.543544 \nL 222.6625 146.563868 \nL 219.610938 146.579676 \nL 216.559375 146.590967 \nL 213.507813 146.597742 \nL 210.45625 146.6 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_7\">\n    <path clip-path=\"url(#p17edc06252)\" d=\"M 43.320212 146.6 \nL 42.620313 146.543544 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"line2d_10\">\n    <path clip-path=\"url(#p17edc06252)\" d=\"M 57.878125 119.952941 \nL 70.084375 34.682353 \nL 81.314125 85.844706 \nL 91.645495 55.147294 \nL 101.150355 73.565741 \nL 109.894827 62.514673 \nL 117.939741 69.145314 \nL 125.341062 65.166929 \nL 132.150277 67.55396 \nL 138.414754 66.121742 \nL 144.178074 66.981073 \nL 149.480328 66.465474 \nL 154.358402 66.774833 \nL 158.84623 66.589218 \nL 162.975031 66.700587 \nL 166.773529 66.633765 \nL 170.268147 66.673858 \nL 173.483195 66.649803 \nL 176.441039 66.664236 \nL 179.162256 66.655576 \nL 181.665776 66.660772 \n\" style=\"fill:none;stroke:#ff7f0e;stroke-linecap:square;stroke-width:1.5;\"/>\n    <defs>\n     <path d=\"M 0 3 \nC 0.795609 3 1.55874 2.683901 2.12132 2.12132 \nC 2.683901 1.55874 3 0.795609 3 0 \nC 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 \nC 1.55874 -2.683901 0.795609 -3 0 -3 \nC -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 \nC -2.683901 -1.55874 -3 -0.795609 -3 0 \nC -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 \nC -1.55874 2.683901 -0.795609 3 0 3 \nz\n\" id=\"m797420545d\" style=\"stroke:#ff7f0e;\"/>\n    </defs>\n    <g clip-path=\"url(#p17edc06252)\">\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"57.878125\" xlink:href=\"#m797420545d\" y=\"119.952941\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"70.084375\" xlink:href=\"#m797420545d\" y=\"34.682353\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"81.314125\" xlink:href=\"#m797420545d\" y=\"85.844706\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"91.645495\" xlink:href=\"#m797420545d\" y=\"55.147294\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"101.150355\" xlink:href=\"#m797420545d\" y=\"73.565741\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"109.894827\" xlink:href=\"#m797420545d\" y=\"62.514673\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"117.939741\" xlink:href=\"#m797420545d\" y=\"69.145314\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"125.341062\" xlink:href=\"#m797420545d\" y=\"65.166929\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"132.150277\" xlink:href=\"#m797420545d\" y=\"67.55396\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"138.414754\" xlink:href=\"#m797420545d\" y=\"66.121742\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"144.178074\" xlink:href=\"#m797420545d\" y=\"66.981073\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"149.480328\" xlink:href=\"#m797420545d\" y=\"66.465474\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"154.358402\" xlink:href=\"#m797420545d\" y=\"66.774833\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"158.84623\" xlink:href=\"#m797420545d\" y=\"66.589218\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"162.975031\" xlink:href=\"#m797420545d\" y=\"66.700587\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"166.773529\" xlink:href=\"#m797420545d\" y=\"66.633765\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"170.268147\" xlink:href=\"#m797420545d\" y=\"66.673858\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"173.483195\" xlink:href=\"#m797420545d\" y=\"66.649803\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"176.441039\" xlink:href=\"#m797420545d\" y=\"66.664236\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"179.162256\" xlink:href=\"#m797420545d\" y=\"66.655576\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"181.665776\" xlink:href=\"#m797420545d\" y=\"66.660772\"/>\n    </g>\n   </g>\n   <g id=\"patch_3\">\n    <path d=\"M 42.620312 146.6 \nL 42.620312 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_4\">\n    <path d=\"M 237.920313 146.6 \nL 237.920313 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_5\">\n    <path d=\"M 42.620313 146.6 \nL 237.920313 146.6 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_6\">\n    <path d=\"M 42.620313 10.7 \nL 237.920313 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n  </g>\n </g>\n <defs>\n  <clipPath id=\"p17edc06252\">\n   <rect height=\"135.9\" width=\"195.3\" x=\"42.620312\" y=\"10.7\"/>\n  </clipPath>\n </defs>\n</svg>\n",
   "text/plain": "<Figure size 252x180 with 1 Axes>"
  },
  "metadata": {},
  "output_type": "display_data"
 }
]
```

可以看到，同一位置上，目标函数在竖直方向（$x_2$轴方向）比在水平方向（$x_1$轴方向）的斜率的绝对值更大。因此，给定学习率，梯度下降迭代自变量时会使自变量在竖直方向比在水平方向移动幅度更大。因此，我们需要一个较小的学习率从而避免自变量在竖直方向上越过目标函数最优解。然而，这造成了图中自变量在水平方向上朝最优解移动较慢。

下面我们试着将学习率调的稍大一点，此时自变量在竖直方向不断越过最优解并逐渐发散。

```{.python .input  n=3}
eta = 0.6
gb.show_trace_2d(f_2d, gb.train_2d(gd_2d))
```

```{.json .output n=3}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "epoch 20, x1 -0.387814, x2 -1673.365109\n"
 },
 {
  "data": {
   "image/svg+xml": "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n  \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Created with matplotlib (http://matplotlib.org/) -->\n<svg height=\"184.15625pt\" version=\"1.1\" viewBox=\"0 0 267.707812 184.15625\" width=\"267.707812pt\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n <defs>\n  <style type=\"text/css\">\n*{stroke-linecap:butt;stroke-linejoin:round;}\n  </style>\n </defs>\n <g id=\"figure_1\">\n  <g id=\"patch_1\">\n   <path d=\"M 0 184.15625 \nL 267.707812 184.15625 \nL 267.707812 -0 \nL 0 -0 \nz\n\" style=\"fill:none;\"/>\n  </g>\n  <g id=\"axes_1\">\n   <g id=\"patch_2\">\n    <path d=\"M 61.707813 146.6 \nL 257.007812 146.6 \nL 257.007812 10.7 \nL 61.707813 10.7 \nz\n\" style=\"fill:#ffffff;\"/>\n   </g>\n   <g id=\"matplotlib.axis_1\">\n    <g id=\"xtick_1\">\n     <g id=\"line2d_1\">\n      <defs>\n       <path d=\"M 0 0 \nL 0 3.5 \n\" id=\"m19ddb178b7\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"107.48125\" xlink:href=\"#m19ddb178b7\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_1\">\n      <!-- \u22124 -->\n      <defs>\n       <path d=\"M 10.59375 35.5 \nL 73.1875 35.5 \nL 73.1875 27.203125 \nL 10.59375 27.203125 \nz\n\" id=\"DejaVuSans-2212\"/>\n       <path d=\"M 37.796875 64.3125 \nL 12.890625 25.390625 \nL 37.796875 25.390625 \nz\nM 35.203125 72.90625 \nL 47.609375 72.90625 \nL 47.609375 25.390625 \nL 58.015625 25.390625 \nL 58.015625 17.1875 \nL 47.609375 17.1875 \nL 47.609375 0 \nL 37.796875 0 \nL 37.796875 17.1875 \nL 4.890625 17.1875 \nL 4.890625 26.703125 \nz\n\" id=\"DejaVuSans-34\"/>\n      </defs>\n      <g transform=\"translate(100.110156 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-34\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_2\">\n     <g id=\"line2d_2\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"168.5125\" xlink:href=\"#m19ddb178b7\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_2\">\n      <!-- \u22122 -->\n      <defs>\n       <path d=\"M 19.1875 8.296875 \nL 53.609375 8.296875 \nL 53.609375 0 \nL 7.328125 0 \nL 7.328125 8.296875 \nQ 12.9375 14.109375 22.625 23.890625 \nQ 32.328125 33.6875 34.8125 36.53125 \nQ 39.546875 41.84375 41.421875 45.53125 \nQ 43.3125 49.21875 43.3125 52.78125 \nQ 43.3125 58.59375 39.234375 62.25 \nQ 35.15625 65.921875 28.609375 65.921875 \nQ 23.96875 65.921875 18.8125 64.3125 \nQ 13.671875 62.703125 7.8125 59.421875 \nL 7.8125 69.390625 \nQ 13.765625 71.78125 18.9375 73 \nQ 24.125 74.21875 28.421875 74.21875 \nQ 39.75 74.21875 46.484375 68.546875 \nQ 53.21875 62.890625 53.21875 53.421875 \nQ 53.21875 48.921875 51.53125 44.890625 \nQ 49.859375 40.875 45.40625 35.40625 \nQ 44.1875 33.984375 37.640625 27.21875 \nQ 31.109375 20.453125 19.1875 8.296875 \nz\n\" id=\"DejaVuSans-32\"/>\n      </defs>\n      <g transform=\"translate(161.141406 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-32\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_3\">\n     <g id=\"line2d_3\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"229.54375\" xlink:href=\"#m19ddb178b7\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_3\">\n      <!-- 0 -->\n      <defs>\n       <path d=\"M 31.78125 66.40625 \nQ 24.171875 66.40625 20.328125 58.90625 \nQ 16.5 51.421875 16.5 36.375 \nQ 16.5 21.390625 20.328125 13.890625 \nQ 24.171875 6.390625 31.78125 6.390625 \nQ 39.453125 6.390625 43.28125 13.890625 \nQ 47.125 21.390625 47.125 36.375 \nQ 47.125 51.421875 43.28125 58.90625 \nQ 39.453125 66.40625 31.78125 66.40625 \nz\nM 31.78125 74.21875 \nQ 44.046875 74.21875 50.515625 64.515625 \nQ 56.984375 54.828125 56.984375 36.375 \nQ 56.984375 17.96875 50.515625 8.265625 \nQ 44.046875 -1.421875 31.78125 -1.421875 \nQ 19.53125 -1.421875 13.0625 8.265625 \nQ 6.59375 17.96875 6.59375 36.375 \nQ 6.59375 54.828125 13.0625 64.515625 \nQ 19.53125 74.21875 31.78125 74.21875 \nz\n\" id=\"DejaVuSans-30\"/>\n      </defs>\n      <g transform=\"translate(226.3625 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_4\">\n     <!-- x1 -->\n     <defs>\n      <path d=\"M 54.890625 54.6875 \nL 35.109375 28.078125 \nL 55.90625 0 \nL 45.3125 0 \nL 29.390625 21.484375 \nL 13.484375 0 \nL 2.875 0 \nL 24.125 28.609375 \nL 4.6875 54.6875 \nL 15.28125 54.6875 \nL 29.78125 35.203125 \nL 44.28125 54.6875 \nz\n\" id=\"DejaVuSans-78\"/>\n      <path d=\"M 12.40625 8.296875 \nL 28.515625 8.296875 \nL 28.515625 63.921875 \nL 10.984375 60.40625 \nL 10.984375 69.390625 \nL 28.421875 72.90625 \nL 38.28125 72.90625 \nL 38.28125 8.296875 \nL 54.390625 8.296875 \nL 54.390625 0 \nL 12.40625 0 \nz\n\" id=\"DejaVuSans-31\"/>\n     </defs>\n     <g transform=\"translate(153.217188 174.876562)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-78\"/>\n      <use x=\"59.179688\" xlink:href=\"#DejaVuSans-31\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"matplotlib.axis_2\">\n    <g id=\"ytick_1\">\n     <g id=\"line2d_4\">\n      <defs>\n       <path d=\"M 0 0 \nL -3.5 0 \n\" id=\"m040ff09a54\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"61.707813\" xlink:href=\"#m040ff09a54\" y=\"138.345204\"/>\n      </g>\n     </g>\n     <g id=\"text_5\">\n      <!-- \u22121500 -->\n      <defs>\n       <path d=\"M 10.796875 72.90625 \nL 49.515625 72.90625 \nL 49.515625 64.59375 \nL 19.828125 64.59375 \nL 19.828125 46.734375 \nQ 21.96875 47.46875 24.109375 47.828125 \nQ 26.265625 48.1875 28.421875 48.1875 \nQ 40.625 48.1875 47.75 41.5 \nQ 54.890625 34.8125 54.890625 23.390625 \nQ 54.890625 11.625 47.5625 5.09375 \nQ 40.234375 -1.421875 26.90625 -1.421875 \nQ 22.3125 -1.421875 17.546875 -0.640625 \nQ 12.796875 0.140625 7.71875 1.703125 \nL 7.71875 11.625 \nQ 12.109375 9.234375 16.796875 8.0625 \nQ 21.484375 6.890625 26.703125 6.890625 \nQ 35.15625 6.890625 40.078125 11.328125 \nQ 45.015625 15.765625 45.015625 23.390625 \nQ 45.015625 31 40.078125 35.4375 \nQ 35.15625 39.890625 26.703125 39.890625 \nQ 22.75 39.890625 18.8125 39.015625 \nQ 14.890625 38.140625 10.796875 36.28125 \nz\n\" id=\"DejaVuSans-35\"/>\n      </defs>\n      <g transform=\"translate(20.878125 142.144422)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-31\"/>\n       <use x=\"147.412109\" xlink:href=\"#DejaVuSans-35\"/>\n       <use x=\"211.035156\" xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"274.658203\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_2\">\n     <g id=\"line2d_5\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"61.707813\" xlink:href=\"#m040ff09a54\" y=\"114.674194\"/>\n      </g>\n     </g>\n     <g id=\"text_6\">\n      <!-- \u22121000 -->\n      <g transform=\"translate(20.878125 118.473413)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-31\"/>\n       <use x=\"147.412109\" xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"211.035156\" xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"274.658203\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_3\">\n     <g id=\"line2d_6\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"61.707813\" xlink:href=\"#m040ff09a54\" y=\"91.003185\"/>\n      </g>\n     </g>\n     <g id=\"text_7\">\n      <!-- \u2212500 -->\n      <g transform=\"translate(27.240625 94.802403)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-35\"/>\n       <use x=\"147.412109\" xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"211.035156\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_4\">\n     <g id=\"line2d_7\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"61.707813\" xlink:href=\"#m040ff09a54\" y=\"67.332175\"/>\n      </g>\n     </g>\n     <g id=\"text_8\">\n      <!-- 0 -->\n      <g transform=\"translate(48.345313 71.131394)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_5\">\n     <g id=\"line2d_8\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"61.707813\" xlink:href=\"#m040ff09a54\" y=\"43.661166\"/>\n      </g>\n     </g>\n     <g id=\"text_9\">\n      <!-- 500 -->\n      <g transform=\"translate(35.620312 47.460384)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-35\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"127.246094\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_6\">\n     <g id=\"line2d_9\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"61.707813\" xlink:href=\"#m040ff09a54\" y=\"19.990156\"/>\n      </g>\n     </g>\n     <g id=\"text_10\">\n      <!-- 1000 -->\n      <g transform=\"translate(29.257812 23.789375)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-31\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"127.246094\" xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"190.869141\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_11\">\n     <!-- x2 -->\n     <g transform=\"translate(14.798438 84.790625)rotate(-90)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-78\"/>\n      <use x=\"59.179688\" xlink:href=\"#DejaVuSans-32\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"LineCollection_1\">\n    <path clip-path=\"url(#pccf94da031)\" d=\"M 257.007812 97.273895 \nL 253.95625 97.273896 \nL 250.904688 97.273896 \nL 247.853125 97.273896 \nL 244.801563 97.273896 \nL 241.75 97.273897 \nL 238.698438 97.273897 \nL 235.646875 97.273897 \nL 232.595313 97.273897 \nL 229.54375 97.273897 \nL 226.492188 97.273897 \nL 223.440625 97.273897 \nL 220.389063 97.273897 \nL 217.3375 97.273897 \nL 214.285938 97.273896 \nL 211.234375 97.273896 \nL 208.182813 97.273896 \nL 205.13125 97.273896 \nL 202.079688 97.273895 \nL 199.028125 97.273895 \nL 195.976562 97.273895 \nL 192.925 97.273894 \nL 189.873438 97.273894 \nL 186.821875 97.273893 \nL 183.770313 97.273893 \nL 180.71875 97.273892 \nL 177.667188 97.273891 \nL 174.615625 97.273891 \nL 171.564063 97.27389 \nL 168.5125 97.273889 \nL 165.460938 97.273889 \nL 162.409375 97.273888 \nL 159.357813 97.273887 \nL 156.30625 97.273886 \nL 153.254688 97.273885 \nL 150.203125 97.273884 \nL 147.151563 97.273883 \nL 144.1 97.273882 \nL 141.048438 97.273881 \nL 137.996875 97.27388 \nL 134.945312 97.273879 \nL 131.89375 97.273878 \nL 128.842188 97.273877 \nL 125.790625 97.273875 \nL 122.739063 97.273874 \nL 119.6875 97.273873 \nL 116.635938 97.273871 \nL 113.584375 97.27387 \nL 110.532813 97.273868 \nL 107.48125 97.273867 \nL 104.429688 97.273865 \nL 101.378125 97.273864 \nL 98.326563 97.273862 \nL 95.275 97.273861 \nL 92.223438 97.273859 \nL 89.171875 97.273857 \nL 86.120313 97.273856 \nL 83.06875 97.273854 \nL 80.017188 97.273852 \nL 76.965625 97.27385 \nL 73.914062 97.273848 \nL 70.8625 97.273846 \nL 67.810937 97.273844 \nL 64.759375 97.273842 \nL 61.707813 97.27384 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#pccf94da031)\" d=\"M 61.707813 37.39051 \nL 64.759375 37.390508 \nL 67.810937 37.390506 \nL 70.8625 37.390504 \nL 73.914062 37.390502 \nL 76.965625 37.3905 \nL 80.017188 37.390498 \nL 83.06875 37.390496 \nL 86.120313 37.390495 \nL 89.171875 37.390493 \nL 92.223438 37.390491 \nL 95.275 37.390489 \nL 98.326563 37.390488 \nL 101.378125 37.390486 \nL 104.429688 37.390485 \nL 107.48125 37.390483 \nL 110.532813 37.390482 \nL 113.584375 37.39048 \nL 116.635938 37.390479 \nL 119.6875 37.390478 \nL 122.739063 37.390476 \nL 125.790625 37.390475 \nL 128.842188 37.390474 \nL 131.89375 37.390472 \nL 134.945312 37.390471 \nL 137.996875 37.39047 \nL 141.048438 37.390469 \nL 144.1 37.390468 \nL 147.151563 37.390467 \nL 150.203125 37.390466 \nL 153.254688 37.390465 \nL 156.30625 37.390464 \nL 159.357813 37.390463 \nL 162.409375 37.390462 \nL 165.460938 37.390462 \nL 168.5125 37.390461 \nL 171.564063 37.39046 \nL 174.615625 37.390459 \nL 177.667188 37.390459 \nL 180.71875 37.390458 \nL 183.770313 37.390457 \nL 186.821875 37.390457 \nL 189.873438 37.390456 \nL 192.925 37.390456 \nL 195.976562 37.390456 \nL 199.028125 37.390455 \nL 202.079688 37.390455 \nL 205.13125 37.390454 \nL 208.182813 37.390454 \nL 211.234375 37.390454 \nL 214.285938 37.390454 \nL 217.3375 37.390454 \nL 220.389063 37.390453 \nL 223.440625 37.390453 \nL 226.492188 37.390453 \nL 229.54375 37.390453 \nL 232.595313 37.390453 \nL 235.646875 37.390453 \nL 238.698438 37.390453 \nL 241.75 37.390454 \nL 244.801563 37.390454 \nL 247.853125 37.390454 \nL 250.904688 37.390454 \nL 253.95625 37.390454 \nL 257.007812 37.390455 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_2\">\n    <path clip-path=\"url(#pccf94da031)\" d=\"M 257.007812 109.676163 \nL 253.95625 109.676163 \nL 250.904688 109.676164 \nL 247.853125 109.676164 \nL 244.801563 109.676164 \nL 241.75 109.676164 \nL 238.698438 109.676164 \nL 235.646875 109.676164 \nL 232.595313 109.676164 \nL 229.54375 109.676164 \nL 226.492188 109.676164 \nL 223.440625 109.676164 \nL 220.389063 109.676164 \nL 217.3375 109.676164 \nL 214.285938 109.676164 \nL 211.234375 109.676164 \nL 208.182813 109.676164 \nL 205.13125 109.676163 \nL 202.079688 109.676163 \nL 199.028125 109.676163 \nL 195.976562 109.676163 \nL 192.925 109.676162 \nL 189.873438 109.676162 \nL 186.821875 109.676162 \nL 183.770313 109.676161 \nL 180.71875 109.676161 \nL 177.667188 109.67616 \nL 174.615625 109.67616 \nL 171.564063 109.676159 \nL 168.5125 109.676159 \nL 165.460938 109.676158 \nL 162.409375 109.676158 \nL 159.357813 109.676157 \nL 156.30625 109.676157 \nL 153.254688 109.676156 \nL 150.203125 109.676155 \nL 147.151563 109.676155 \nL 144.1 109.676154 \nL 141.048438 109.676153 \nL 137.996875 109.676152 \nL 134.945312 109.676151 \nL 131.89375 109.676151 \nL 128.842188 109.67615 \nL 125.790625 109.676149 \nL 122.739063 109.676148 \nL 119.6875 109.676147 \nL 116.635938 109.676146 \nL 113.584375 109.676145 \nL 110.532813 109.676144 \nL 107.48125 109.676143 \nL 104.429688 109.676142 \nL 101.378125 109.676141 \nL 98.326563 109.67614 \nL 95.275 109.676139 \nL 92.223438 109.676137 \nL 89.171875 109.676136 \nL 86.120313 109.676135 \nL 83.06875 109.676134 \nL 80.017188 109.676132 \nL 76.965625 109.676131 \nL 73.914062 109.67613 \nL 70.8625 109.676128 \nL 67.810937 109.676127 \nL 64.759375 109.676126 \nL 61.707813 109.676124 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#pccf94da031)\" d=\"M 61.707813 24.988226 \nL 64.759375 24.988225 \nL 67.810938 24.988223 \nL 70.8625 24.988222 \nL 73.914062 24.98822 \nL 76.965625 24.988219 \nL 80.017188 24.988218 \nL 83.06875 24.988216 \nL 86.120313 24.988215 \nL 89.171875 24.988214 \nL 92.223438 24.988213 \nL 95.275 24.988212 \nL 98.326563 24.98821 \nL 101.378125 24.988209 \nL 104.429688 24.988208 \nL 107.48125 24.988207 \nL 110.532813 24.988206 \nL 113.584375 24.988205 \nL 116.635938 24.988204 \nL 119.6875 24.988203 \nL 122.739063 24.988202 \nL 125.790625 24.988201 \nL 128.842188 24.9882 \nL 131.89375 24.988199 \nL 134.945312 24.988199 \nL 137.996875 24.988198 \nL 141.048438 24.988197 \nL 144.1 24.988196 \nL 147.151563 24.988196 \nL 150.203125 24.988195 \nL 153.254688 24.988194 \nL 156.30625 24.988194 \nL 159.357813 24.988193 \nL 162.409375 24.988192 \nL 165.460938 24.988192 \nL 168.5125 24.988191 \nL 171.564063 24.988191 \nL 174.615625 24.98819 \nL 177.667188 24.98819 \nL 180.71875 24.988189 \nL 183.770313 24.988189 \nL 186.821875 24.988189 \nL 189.873438 24.988188 \nL 192.925 24.988188 \nL 195.976562 24.988188 \nL 199.028125 24.988187 \nL 202.079688 24.988187 \nL 205.13125 24.988187 \nL 208.182813 24.988187 \nL 211.234375 24.988186 \nL 214.285938 24.988186 \nL 217.3375 24.988186 \nL 220.389063 24.988186 \nL 223.440625 24.988186 \nL 226.492188 24.988186 \nL 229.54375 24.988186 \nL 232.595313 24.988186 \nL 235.646875 24.988186 \nL 238.698438 24.988186 \nL 241.75 24.988186 \nL 244.801563 24.988186 \nL 247.853125 24.988186 \nL 250.904688 24.988187 \nL 253.95625 24.988187 \nL 257.007812 24.988187 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_3\">\n    <path clip-path=\"url(#pccf94da031)\" d=\"M 257.007812 119.192758 \nL 253.95625 119.192758 \nL 250.904688 119.192758 \nL 247.853125 119.192758 \nL 244.801563 119.192758 \nL 241.75 119.192758 \nL 238.698438 119.192758 \nL 235.646875 119.192759 \nL 232.595313 119.192759 \nL 229.54375 119.192759 \nL 226.492188 119.192759 \nL 223.440625 119.192759 \nL 220.389063 119.192758 \nL 217.3375 119.192758 \nL 214.285938 119.192758 \nL 211.234375 119.192758 \nL 208.182813 119.192758 \nL 205.13125 119.192758 \nL 202.079688 119.192758 \nL 199.028125 119.192758 \nL 195.976562 119.192757 \nL 192.925 119.192757 \nL 189.873438 119.192757 \nL 186.821875 119.192756 \nL 183.770313 119.192756 \nL 180.71875 119.192756 \nL 177.667188 119.192755 \nL 174.615625 119.192755 \nL 171.564063 119.192755 \nL 168.5125 119.192754 \nL 165.460938 119.192754 \nL 162.409375 119.192753 \nL 159.357813 119.192753 \nL 156.30625 119.192752 \nL 153.254688 119.192752 \nL 150.203125 119.192751 \nL 147.151563 119.192751 \nL 144.1 119.19275 \nL 141.048438 119.192749 \nL 137.996875 119.192749 \nL 134.945312 119.192748 \nL 131.89375 119.192748 \nL 128.842188 119.192747 \nL 125.790625 119.192746 \nL 122.739063 119.192745 \nL 119.6875 119.192745 \nL 116.635938 119.192744 \nL 113.584375 119.192743 \nL 110.532813 119.192742 \nL 107.48125 119.192741 \nL 104.429688 119.19274 \nL 101.378125 119.19274 \nL 98.326563 119.192739 \nL 95.275 119.192738 \nL 92.223438 119.192737 \nL 89.171875 119.192736 \nL 86.120313 119.192735 \nL 83.06875 119.192734 \nL 80.017188 119.192733 \nL 76.965625 119.192732 \nL 73.914062 119.19273 \nL 70.8625 119.192729 \nL 67.810937 119.192728 \nL 64.759375 119.192727 \nL 61.707813 119.192726 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#pccf94da031)\" d=\"M 61.707813 15.471624 \nL 64.759375 15.471623 \nL 67.810937 15.471622 \nL 70.8625 15.471621 \nL 73.914062 15.47162 \nL 76.965625 15.471619 \nL 80.017188 15.471617 \nL 83.06875 15.471616 \nL 86.120313 15.471615 \nL 89.171875 15.471614 \nL 92.223438 15.471613 \nL 95.275 15.471612 \nL 98.326563 15.471612 \nL 101.378125 15.471611 \nL 104.429688 15.47161 \nL 107.48125 15.471609 \nL 110.532813 15.471608 \nL 113.584375 15.471607 \nL 116.635938 15.471606 \nL 119.6875 15.471606 \nL 122.739063 15.471605 \nL 125.790625 15.471604 \nL 128.842188 15.471603 \nL 131.89375 15.471603 \nL 134.945312 15.471602 \nL 137.996875 15.471601 \nL 141.048438 15.471601 \nL 144.1 15.4716 \nL 147.151563 15.471599 \nL 150.203125 15.471599 \nL 153.254688 15.471598 \nL 156.30625 15.471598 \nL 159.357813 15.471597 \nL 162.409375 15.471597 \nL 165.460938 15.471596 \nL 168.5125 15.471596 \nL 171.564063 15.471595 \nL 174.615625 15.471595 \nL 177.667188 15.471595 \nL 180.71875 15.471594 \nL 183.770313 15.471594 \nL 186.821875 15.471594 \nL 189.873438 15.471593 \nL 192.925 15.471593 \nL 195.976562 15.471593 \nL 199.028125 15.471593 \nL 202.079688 15.471592 \nL 205.13125 15.471592 \nL 208.182813 15.471592 \nL 211.234375 15.471592 \nL 214.285938 15.471592 \nL 217.3375 15.471592 \nL 220.389063 15.471592 \nL 223.440625 15.471592 \nL 226.492188 15.471592 \nL 229.54375 15.471592 \nL 232.595313 15.471592 \nL 235.646875 15.471592 \nL 238.698438 15.471592 \nL 241.75 15.471592 \nL 244.801563 15.471592 \nL 247.853125 15.471592 \nL 250.904688 15.471592 \nL 253.95625 15.471592 \nL 257.007812 15.471592 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_4\">\n    <path clip-path=\"url(#pccf94da031)\" d=\"M 257.007812 127.215618 \nL 253.95625 127.215618 \nL 250.904688 127.215618 \nL 247.853125 127.215618 \nL 244.801563 127.215619 \nL 241.75 127.215619 \nL 238.698438 127.215619 \nL 235.646875 127.215619 \nL 232.595313 127.215619 \nL 229.54375 127.215619 \nL 226.492188 127.215619 \nL 223.440625 127.215619 \nL 220.389063 127.215619 \nL 217.3375 127.215619 \nL 214.285938 127.215619 \nL 211.234375 127.215618 \nL 208.182813 127.215618 \nL 205.13125 127.215618 \nL 202.079688 127.215618 \nL 199.028125 127.215618 \nL 195.976562 127.215618 \nL 192.925 127.215617 \nL 189.873438 127.215617 \nL 186.821875 127.215617 \nL 183.770313 127.215617 \nL 180.71875 127.215616 \nL 177.667188 127.215616 \nL 174.615625 127.215616 \nL 171.564063 127.215615 \nL 168.5125 127.215615 \nL 165.460938 127.215615 \nL 162.409375 127.215614 \nL 159.357813 127.215614 \nL 156.30625 127.215613 \nL 153.254688 127.215613 \nL 150.203125 127.215612 \nL 147.151563 127.215612 \nL 144.1 127.215611 \nL 141.048438 127.215611 \nL 137.996875 127.21561 \nL 134.945312 127.21561 \nL 131.89375 127.215609 \nL 128.842188 127.215609 \nL 125.790625 127.215608 \nL 122.739063 127.215607 \nL 119.6875 127.215607 \nL 116.635938 127.215606 \nL 113.584375 127.215605 \nL 110.532813 127.215605 \nL 107.48125 127.215604 \nL 104.429688 127.215603 \nL 101.378125 127.215602 \nL 98.326563 127.215601 \nL 95.275 127.215601 \nL 92.223438 127.2156 \nL 89.171875 127.215599 \nL 86.120313 127.215598 \nL 83.06875 127.215597 \nL 80.017188 127.215596 \nL 76.965625 127.215595 \nL 73.914062 127.215594 \nL 70.8625 127.215593 \nL 67.810937 127.215592 \nL 64.759375 127.215591 \nL 61.707813 127.21559 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_5\">\n    <path clip-path=\"url(#pccf94da031)\" d=\"M 257.007812 134.2839 \nL 253.95625 134.2839 \nL 250.904688 134.2839 \nL 247.853125 134.2839 \nL 244.801563 134.2839 \nL 241.75 134.2839 \nL 238.698438 134.2839 \nL 235.646875 134.2839 \nL 232.595313 134.2839 \nL 229.54375 134.2839 \nL 226.492188 134.2839 \nL 223.440625 134.2839 \nL 220.389063 134.2839 \nL 217.3375 134.2839 \nL 214.285938 134.2839 \nL 211.234375 134.2839 \nL 208.182813 134.2839 \nL 205.13125 134.2839 \nL 202.079688 134.2839 \nL 199.028125 134.2839 \nL 195.976562 134.283899 \nL 192.925 134.283899 \nL 189.873438 134.283899 \nL 186.821875 134.283899 \nL 183.770313 134.283899 \nL 180.71875 134.283898 \nL 177.667188 134.283898 \nL 174.615625 134.283898 \nL 171.564063 134.283897 \nL 168.5125 134.283897 \nL 165.460938 134.283897 \nL 162.409375 134.283896 \nL 159.357813 134.283896 \nL 156.30625 134.283896 \nL 153.254688 134.283895 \nL 150.203125 134.283895 \nL 147.151563 134.283894 \nL 144.1 134.283894 \nL 141.048438 134.283893 \nL 137.996875 134.283893 \nL 134.945312 134.283892 \nL 131.89375 134.283892 \nL 128.842188 134.283891 \nL 125.790625 134.283891 \nL 122.739063 134.28389 \nL 119.6875 134.28389 \nL 116.635938 134.283889 \nL 113.584375 134.283888 \nL 110.532813 134.283888 \nL 107.48125 134.283887 \nL 104.429688 134.283886 \nL 101.378125 134.283886 \nL 98.326563 134.283885 \nL 95.275 134.283884 \nL 92.223438 134.283884 \nL 89.171875 134.283883 \nL 86.120313 134.283882 \nL 83.06875 134.283881 \nL 80.017188 134.28388 \nL 76.965625 134.28388 \nL 73.914062 134.283879 \nL 70.8625 134.283878 \nL 67.810937 134.283877 \nL 64.759375 134.283876 \nL 61.707813 134.283875 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_6\">\n    <path clip-path=\"url(#pccf94da031)\" d=\"M 257.007812 140.674115 \nL 253.95625 140.674115 \nL 250.904688 140.674115 \nL 247.853125 140.674115 \nL 244.801563 140.674115 \nL 241.75 140.674116 \nL 238.698438 140.674116 \nL 235.646875 140.674116 \nL 232.595313 140.674116 \nL 229.54375 140.674116 \nL 226.492188 140.674116 \nL 223.440625 140.674116 \nL 220.389063 140.674116 \nL 217.3375 140.674116 \nL 214.285938 140.674115 \nL 211.234375 140.674115 \nL 208.182813 140.674115 \nL 205.13125 140.674115 \nL 202.079688 140.674115 \nL 199.028125 140.674115 \nL 195.976562 140.674115 \nL 192.925 140.674115 \nL 189.873438 140.674114 \nL 186.821875 140.674114 \nL 183.770313 140.674114 \nL 180.71875 140.674114 \nL 177.667188 140.674113 \nL 174.615625 140.674113 \nL 171.564063 140.674113 \nL 168.5125 140.674113 \nL 165.460938 140.674112 \nL 162.409375 140.674112 \nL 159.357813 140.674112 \nL 156.30625 140.674111 \nL 153.254688 140.674111 \nL 150.203125 140.67411 \nL 147.151563 140.67411 \nL 144.1 140.67411 \nL 141.048438 140.674109 \nL 137.996875 140.674109 \nL 134.945312 140.674108 \nL 131.89375 140.674108 \nL 128.842188 140.674107 \nL 125.790625 140.674107 \nL 122.739063 140.674106 \nL 119.6875 140.674106 \nL 116.635938 140.674105 \nL 113.584375 140.674105 \nL 110.532813 140.674104 \nL 107.48125 140.674103 \nL 104.429688 140.674103 \nL 101.378125 140.674102 \nL 98.326563 140.674102 \nL 95.275 140.674101 \nL 92.223438 140.6741 \nL 89.171875 140.674099 \nL 86.120313 140.674099 \nL 83.06875 140.674098 \nL 80.017188 140.674097 \nL 76.965625 140.674097 \nL 73.914062 140.674096 \nL 70.8625 140.674095 \nL 67.810937 140.674094 \nL 64.759375 140.674093 \nL 61.707813 140.674093 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_7\">\n    <path clip-path=\"url(#pccf94da031)\" d=\"M 257.007812 146.550524 \nL 253.95625 146.550524 \nL 250.904688 146.550525 \nL 247.853125 146.550525 \nL 244.801563 146.550525 \nL 241.75 146.550525 \nL 238.698438 146.550525 \nL 235.646875 146.550525 \nL 232.595313 146.550525 \nL 229.54375 146.550525 \nL 226.492188 146.550525 \nL 223.440625 146.550525 \nL 220.389063 146.550525 \nL 217.3375 146.550525 \nL 214.285938 146.550525 \nL 211.234375 146.550525 \nL 208.182813 146.550525 \nL 205.13125 146.550524 \nL 202.079688 146.550524 \nL 199.028125 146.550524 \nL 195.976562 146.550524 \nL 192.925 146.550524 \nL 189.873438 146.550524 \nL 186.821875 146.550524 \nL 183.770313 146.550523 \nL 180.71875 146.550523 \nL 177.667188 146.550523 \nL 174.615625 146.550523 \nL 171.564063 146.550522 \nL 168.5125 146.550522 \nL 165.460938 146.550522 \nL 162.409375 146.550522 \nL 159.357813 146.550521 \nL 156.30625 146.550521 \nL 153.254688 146.550521 \nL 150.203125 146.55052 \nL 147.151563 146.55052 \nL 144.1 146.550519 \nL 141.048438 146.550519 \nL 137.996875 146.550519 \nL 134.945312 146.550518 \nL 131.89375 146.550518 \nL 128.842188 146.550517 \nL 125.790625 146.550517 \nL 122.739063 146.550516 \nL 119.6875 146.550516 \nL 116.635938 146.550515 \nL 113.584375 146.550515 \nL 110.532812 146.550514 \nL 107.48125 146.550514 \nL 104.429688 146.550513 \nL 101.378125 146.550512 \nL 98.326563 146.550512 \nL 95.275 146.550511 \nL 92.223438 146.550511 \nL 89.171875 146.55051 \nL 86.120313 146.550509 \nL 83.06875 146.550509 \nL 80.017188 146.550508 \nL 76.965625 146.550507 \nL 73.914062 146.550507 \nL 70.8625 146.550506 \nL 67.810937 146.550505 \nL 64.759375 146.550504 \nL 61.707813 146.550504 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"line2d_10\">\n    <path clip-path=\"url(#pccf94da031)\" d=\"M 76.965625 67.426859 \nL 95.275 67.199617 \nL 111.38725 67.517756 \nL 125.56603 67.072362 \nL 138.043356 67.695913 \nL 149.023404 66.822942 \nL 158.685845 68.045102 \nL 167.188794 66.334077 \nL 174.671389 68.729512 \nL 181.256072 65.375904 \nL 187.050593 70.070955 \nL 192.149772 63.497883 \nL 196.637049 72.700184 \nL 200.585853 59.816963 \nL 204.060801 77.853472 \nL 207.118755 52.60236 \nL 209.809754 87.953917 \nL 212.177834 38.461737 \nL 214.261744 107.750789 \nL 216.095585 10.746116 \nL 217.709364 146.552658 \n\" style=\"fill:none;stroke:#ff7f0e;stroke-linecap:square;stroke-width:1.5;\"/>\n    <defs>\n     <path d=\"M 0 3 \nC 0.795609 3 1.55874 2.683901 2.12132 2.12132 \nC 2.683901 1.55874 3 0.795609 3 0 \nC 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 \nC 1.55874 -2.683901 0.795609 -3 0 -3 \nC -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 \nC -2.683901 -1.55874 -3 -0.795609 -3 0 \nC -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 \nC -1.55874 2.683901 -0.795609 3 0 3 \nz\n\" id=\"m218f34755d\" style=\"stroke:#ff7f0e;\"/>\n    </defs>\n    <g clip-path=\"url(#pccf94da031)\">\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"76.965625\" xlink:href=\"#m218f34755d\" y=\"67.426859\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"95.275\" xlink:href=\"#m218f34755d\" y=\"67.199617\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"111.38725\" xlink:href=\"#m218f34755d\" y=\"67.517756\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"125.56603\" xlink:href=\"#m218f34755d\" y=\"67.072362\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"138.043356\" xlink:href=\"#m218f34755d\" y=\"67.695913\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"149.023404\" xlink:href=\"#m218f34755d\" y=\"66.822942\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"158.685845\" xlink:href=\"#m218f34755d\" y=\"68.045102\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"167.188794\" xlink:href=\"#m218f34755d\" y=\"66.334077\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"174.671389\" xlink:href=\"#m218f34755d\" y=\"68.729512\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"181.256072\" xlink:href=\"#m218f34755d\" y=\"65.375904\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"187.050593\" xlink:href=\"#m218f34755d\" y=\"70.070955\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"192.149772\" xlink:href=\"#m218f34755d\" y=\"63.497883\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"196.637049\" xlink:href=\"#m218f34755d\" y=\"72.700184\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"200.585853\" xlink:href=\"#m218f34755d\" y=\"59.816963\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"204.060801\" xlink:href=\"#m218f34755d\" y=\"77.853472\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"207.118755\" xlink:href=\"#m218f34755d\" y=\"52.60236\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"209.809754\" xlink:href=\"#m218f34755d\" y=\"87.953917\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"212.177834\" xlink:href=\"#m218f34755d\" y=\"38.461737\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"214.261744\" xlink:href=\"#m218f34755d\" y=\"107.750789\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"216.095585\" xlink:href=\"#m218f34755d\" y=\"10.746116\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"217.709364\" xlink:href=\"#m218f34755d\" y=\"146.552658\"/>\n    </g>\n   </g>\n   <g id=\"patch_3\">\n    <path d=\"M 61.707813 146.6 \nL 61.707813 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_4\">\n    <path d=\"M 257.007812 146.6 \nL 257.007812 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_5\">\n    <path d=\"M 61.707813 146.6 \nL 257.007812 146.6 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_6\">\n    <path d=\"M 61.707813 10.7 \nL 257.007812 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n  </g>\n </g>\n <defs>\n  <clipPath id=\"pccf94da031\">\n   <rect height=\"135.9\" width=\"195.3\" x=\"61.707813\" y=\"10.7\"/>\n  </clipPath>\n </defs>\n</svg>\n",
   "text/plain": "<Figure size 252x180 with 1 Axes>"
  },
  "metadata": {},
  "output_type": "display_data"
 }
]
```

## 动量法

动量法的提出是为了应对梯度下降的上述问题。在时间步$0$，动量法创建速度变量$\boldsymbol{v}_0\in\mathbb{R}^d$，并将其元素初始化成0。在时间步$t>0$，动量法对每次迭代的步骤做如下修改：

$$
\begin{aligned}
\boldsymbol{v}_t &\leftarrow \gamma \boldsymbol{v}_{t-1} + \eta_t \boldsymbol{g}_t \\
\boldsymbol{x}_t &\leftarrow \boldsymbol{x}_{t-1} - \boldsymbol{v}_t,
\end{aligned}
$$

其中，动量超参数$\gamma$满足$0 \leq \gamma < 1$。当$\gamma=0$时，动量法等价于小批量随机梯度下降。动量法中的学习率$\eta_t$和梯度$\boldsymbol{g_t}$已在[“小批量随机梯度下降”](minibatch-sgd.md)一节中描述。

在解释动量法的数学原理前，让我们先从实验中观察梯度下降在使用动量法后的迭代过程。

```{.python .input  n=4}
def momentum_2d(x1, x2, v1, v2):
    v1 = mom * v1 + eta * 0.2 * x1
    v2 = mom * v2 + eta * 4 * x2
    return x1 - v1, x2 - v2, v1, v2

eta, mom = 0.4, 0.5
gb.show_trace_2d(f_2d, gb.train_2d(momentum_2d))
```

```{.json .output n=4}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "epoch 20, x1 -0.062843, x2 0.001202\n"
 },
 {
  "data": {
   "image/svg+xml": "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n  \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Created with matplotlib (http://matplotlib.org/) -->\n<svg height=\"184.15625pt\" version=\"1.1\" viewBox=\"0 0 248.620313 184.15625\" width=\"248.620313pt\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n <defs>\n  <style type=\"text/css\">\n*{stroke-linecap:butt;stroke-linejoin:round;}\n  </style>\n </defs>\n <g id=\"figure_1\">\n  <g id=\"patch_1\">\n   <path d=\"M 0 184.15625 \nL 248.620313 184.15625 \nL 248.620313 -0 \nL 0 -0 \nz\n\" style=\"fill:none;\"/>\n  </g>\n  <g id=\"axes_1\">\n   <g id=\"patch_2\">\n    <path d=\"M 42.620312 146.6 \nL 237.920313 146.6 \nL 237.920313 10.7 \nL 42.620312 10.7 \nz\n\" style=\"fill:#ffffff;\"/>\n   </g>\n   <g id=\"matplotlib.axis_1\">\n    <g id=\"xtick_1\">\n     <g id=\"line2d_1\">\n      <defs>\n       <path d=\"M 0 0 \nL 0 3.5 \n\" id=\"m2db85b112c\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"88.39375\" xlink:href=\"#m2db85b112c\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_1\">\n      <!-- \u22124 -->\n      <defs>\n       <path d=\"M 10.59375 35.5 \nL 73.1875 35.5 \nL 73.1875 27.203125 \nL 10.59375 27.203125 \nz\n\" id=\"DejaVuSans-2212\"/>\n       <path d=\"M 37.796875 64.3125 \nL 12.890625 25.390625 \nL 37.796875 25.390625 \nz\nM 35.203125 72.90625 \nL 47.609375 72.90625 \nL 47.609375 25.390625 \nL 58.015625 25.390625 \nL 58.015625 17.1875 \nL 47.609375 17.1875 \nL 47.609375 0 \nL 37.796875 0 \nL 37.796875 17.1875 \nL 4.890625 17.1875 \nL 4.890625 26.703125 \nz\n\" id=\"DejaVuSans-34\"/>\n      </defs>\n      <g transform=\"translate(81.022656 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-34\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_2\">\n     <g id=\"line2d_2\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"149.425\" xlink:href=\"#m2db85b112c\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_2\">\n      <!-- \u22122 -->\n      <defs>\n       <path d=\"M 19.1875 8.296875 \nL 53.609375 8.296875 \nL 53.609375 0 \nL 7.328125 0 \nL 7.328125 8.296875 \nQ 12.9375 14.109375 22.625 23.890625 \nQ 32.328125 33.6875 34.8125 36.53125 \nQ 39.546875 41.84375 41.421875 45.53125 \nQ 43.3125 49.21875 43.3125 52.78125 \nQ 43.3125 58.59375 39.234375 62.25 \nQ 35.15625 65.921875 28.609375 65.921875 \nQ 23.96875 65.921875 18.8125 64.3125 \nQ 13.671875 62.703125 7.8125 59.421875 \nL 7.8125 69.390625 \nQ 13.765625 71.78125 18.9375 73 \nQ 24.125 74.21875 28.421875 74.21875 \nQ 39.75 74.21875 46.484375 68.546875 \nQ 53.21875 62.890625 53.21875 53.421875 \nQ 53.21875 48.921875 51.53125 44.890625 \nQ 49.859375 40.875 45.40625 35.40625 \nQ 44.1875 33.984375 37.640625 27.21875 \nQ 31.109375 20.453125 19.1875 8.296875 \nz\n\" id=\"DejaVuSans-32\"/>\n      </defs>\n      <g transform=\"translate(142.053906 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-32\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_3\">\n     <g id=\"line2d_3\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"210.45625\" xlink:href=\"#m2db85b112c\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_3\">\n      <!-- 0 -->\n      <defs>\n       <path d=\"M 31.78125 66.40625 \nQ 24.171875 66.40625 20.328125 58.90625 \nQ 16.5 51.421875 16.5 36.375 \nQ 16.5 21.390625 20.328125 13.890625 \nQ 24.171875 6.390625 31.78125 6.390625 \nQ 39.453125 6.390625 43.28125 13.890625 \nQ 47.125 21.390625 47.125 36.375 \nQ 47.125 51.421875 43.28125 58.90625 \nQ 39.453125 66.40625 31.78125 66.40625 \nz\nM 31.78125 74.21875 \nQ 44.046875 74.21875 50.515625 64.515625 \nQ 56.984375 54.828125 56.984375 36.375 \nQ 56.984375 17.96875 50.515625 8.265625 \nQ 44.046875 -1.421875 31.78125 -1.421875 \nQ 19.53125 -1.421875 13.0625 8.265625 \nQ 6.59375 17.96875 6.59375 36.375 \nQ 6.59375 54.828125 13.0625 64.515625 \nQ 19.53125 74.21875 31.78125 74.21875 \nz\n\" id=\"DejaVuSans-30\"/>\n      </defs>\n      <g transform=\"translate(207.275 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_4\">\n     <!-- x1 -->\n     <defs>\n      <path d=\"M 54.890625 54.6875 \nL 35.109375 28.078125 \nL 55.90625 0 \nL 45.3125 0 \nL 29.390625 21.484375 \nL 13.484375 0 \nL 2.875 0 \nL 24.125 28.609375 \nL 4.6875 54.6875 \nL 15.28125 54.6875 \nL 29.78125 35.203125 \nL 44.28125 54.6875 \nz\n\" id=\"DejaVuSans-78\"/>\n      <path d=\"M 12.40625 8.296875 \nL 28.515625 8.296875 \nL 28.515625 63.921875 \nL 10.984375 60.40625 \nL 10.984375 69.390625 \nL 28.421875 72.90625 \nL 38.28125 72.90625 \nL 38.28125 8.296875 \nL 54.390625 8.296875 \nL 54.390625 0 \nL 12.40625 0 \nz\n\" id=\"DejaVuSans-31\"/>\n     </defs>\n     <g transform=\"translate(134.129687 174.876562)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-78\"/>\n      <use x=\"59.179688\" xlink:href=\"#DejaVuSans-31\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"matplotlib.axis_2\">\n    <g id=\"ytick_1\">\n     <g id=\"line2d_4\">\n      <defs>\n       <path d=\"M 0 0 \nL -3.5 0 \n\" id=\"mab4fbae1ef\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#mab4fbae1ef\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_5\">\n      <!-- \u22123 -->\n      <defs>\n       <path d=\"M 40.578125 39.3125 \nQ 47.65625 37.796875 51.625 33 \nQ 55.609375 28.21875 55.609375 21.1875 \nQ 55.609375 10.40625 48.1875 4.484375 \nQ 40.765625 -1.421875 27.09375 -1.421875 \nQ 22.515625 -1.421875 17.65625 -0.515625 \nQ 12.796875 0.390625 7.625 2.203125 \nL 7.625 11.71875 \nQ 11.71875 9.328125 16.59375 8.109375 \nQ 21.484375 6.890625 26.8125 6.890625 \nQ 36.078125 6.890625 40.9375 10.546875 \nQ 45.796875 14.203125 45.796875 21.1875 \nQ 45.796875 27.640625 41.28125 31.265625 \nQ 36.765625 34.90625 28.71875 34.90625 \nL 20.21875 34.90625 \nL 20.21875 43.015625 \nL 29.109375 43.015625 \nQ 36.375 43.015625 40.234375 45.921875 \nQ 44.09375 48.828125 44.09375 54.296875 \nQ 44.09375 59.90625 40.109375 62.90625 \nQ 36.140625 65.921875 28.71875 65.921875 \nQ 24.65625 65.921875 20.015625 65.03125 \nQ 15.375 64.15625 9.8125 62.3125 \nL 9.8125 71.09375 \nQ 15.4375 72.65625 20.34375 73.4375 \nQ 25.25 74.21875 29.59375 74.21875 \nQ 40.828125 74.21875 47.359375 69.109375 \nQ 53.90625 64.015625 53.90625 55.328125 \nQ 53.90625 49.265625 50.4375 45.09375 \nQ 46.96875 40.921875 40.578125 39.3125 \nz\n\" id=\"DejaVuSans-33\"/>\n      </defs>\n      <g transform=\"translate(20.878125 150.399219)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-33\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_2\">\n     <g id=\"line2d_5\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#mab4fbae1ef\" y=\"119.952941\"/>\n      </g>\n     </g>\n     <g id=\"text_6\">\n      <!-- \u22122 -->\n      <g transform=\"translate(20.878125 123.75216)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-32\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_3\">\n     <g id=\"line2d_6\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#mab4fbae1ef\" y=\"93.305882\"/>\n      </g>\n     </g>\n     <g id=\"text_7\">\n      <!-- \u22121 -->\n      <g transform=\"translate(20.878125 97.105101)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-31\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_4\">\n     <g id=\"line2d_7\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#mab4fbae1ef\" y=\"66.658824\"/>\n      </g>\n     </g>\n     <g id=\"text_8\">\n      <!-- 0 -->\n      <g transform=\"translate(29.257812 70.458042)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_5\">\n     <g id=\"line2d_8\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#mab4fbae1ef\" y=\"40.011765\"/>\n      </g>\n     </g>\n     <g id=\"text_9\">\n      <!-- 1 -->\n      <g transform=\"translate(29.257812 43.810983)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-31\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_6\">\n     <g id=\"line2d_9\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#mab4fbae1ef\" y=\"13.364706\"/>\n      </g>\n     </g>\n     <g id=\"text_10\">\n      <!-- 2 -->\n      <g transform=\"translate(29.257812 17.163925)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-32\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_11\">\n     <!-- x2 -->\n     <g transform=\"translate(14.798437 84.790625)rotate(-90)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-78\"/>\n      <use x=\"59.179688\" xlink:href=\"#DejaVuSans-32\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"LineCollection_1\">\n    <path clip-path=\"url(#pd53dd10434)\" d=\"M 237.920313 98.843141 \nL 222.6625 99.189553 \nL 207.404688 99.269494 \nL 192.146875 99.082965 \nL 176.889063 98.629501 \nL 164.682813 98.027046 \nL 152.476563 97.23922 \nL 140.270313 96.266023 \nL 131.115625 95.361513 \nL 118.909375 93.940336 \nL 109.754688 92.68178 \nL 97.100875 90.641176 \nL 85.342188 88.282128 \nL 82.290625 87.585647 \nL 73.135938 85.26052 \nL 63.98125 82.356364 \nL 57.878125 79.982353 \nL 52.486044 77.317647 \nL 48.409725 74.652941 \nL 45.559891 71.988235 \nL 43.880132 69.323529 \nL 43.320212 66.658824 \nL 43.880132 63.994118 \nL 45.671875 61.222824 \nL 48.723438 58.455336 \nL 52.486044 56 \nL 57.878125 53.335294 \nL 64.752171 50.670588 \nL 73.307374 48.005882 \nL 83.908321 45.341176 \nL 94.496875 43.178062 \nL 100.6 42.08743 \nL 113.96875 40.011765 \nL 125.0125 38.641345 \nL 137.21875 37.323887 \nL 149.425 36.304348 \nL 161.63125 35.470179 \nL 173.8375 34.821381 \nL 186.04375 34.383906 \nL 201.301563 34.090788 \nL 216.559375 34.064141 \nL 231.817188 34.303965 \nL 237.920313 34.474506 \nL 237.920313 34.474506 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_2\">\n    <path clip-path=\"url(#pd53dd10434)\" d=\"M 237.920313 112.487958 \nL 234.86875 112.552672 \nL 231.817188 112.609773 \nL 228.765625 112.659261 \nL 225.714063 112.701134 \nL 222.6625 112.735395 \nL 219.610938 112.762042 \nL 216.559375 112.781076 \nL 213.507813 112.792496 \nL 210.45625 112.796303 \nL 207.404688 112.792496 \nL 204.353125 112.781076 \nL 201.301563 112.762042 \nL 198.25 112.735395 \nL 195.198438 112.701134 \nL 192.146875 112.659261 \nL 189.095313 112.609773 \nL 186.04375 112.552672 \nL 182.992188 112.487958 \nL 179.940625 112.41563 \nL 176.889063 112.335689 \nL 173.8375 112.248134 \nL 170.785938 112.152966 \nL 167.734375 112.050185 \nL 165.208944 111.958824 \nL 164.682813 111.938636 \nL 161.63125 111.813476 \nL 158.579688 111.680241 \nL 155.528125 111.53893 \nL 152.476563 111.389545 \nL 149.425 111.232086 \nL 146.373438 111.066551 \nL 143.321875 110.892941 \nL 140.270313 110.711257 \nL 137.21875 110.521497 \nL 134.167188 110.323663 \nL 131.115625 110.117754 \nL 128.064063 109.90377 \nL 125.0125 109.681711 \nL 121.960938 109.451578 \nL 119.943803 109.294118 \nL 118.909375 109.208159 \nL 115.857813 108.945987 \nL 112.80625 108.675218 \nL 109.754688 108.395854 \nL 106.703125 108.107894 \nL 103.651563 107.811338 \nL 100.6 107.506186 \nL 97.548438 107.192438 \nL 94.496875 106.870095 \nL 92.277557 106.629412 \nL 91.445313 106.532931 \nL 88.39375 106.16998 \nL 85.342188 105.79784 \nL 82.290625 105.416511 \nL 79.239063 105.025994 \nL 76.1875 104.626288 \nL 73.135938 104.217394 \nL 71.291587 103.964706 \nL 70.084375 103.787059 \nL 67.032813 103.328137 \nL 63.98125 102.859346 \nL 60.929688 102.380686 \nL 57.878125 101.892157 \nL 54.826563 101.393758 \nL 54.263653 101.3 \nL 51.775 100.852329 \nL 48.723438 100.292741 \nL 45.671875 99.722494 \nL 42.620313 99.141588 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#pd53dd10434)\" d=\"M 42.620313 34.176059 \nL 45.671875 33.595153 \nL 48.723438 33.024906 \nL 51.775 32.465318 \nL 54.263653 32.017647 \nL 54.826563 31.923889 \nL 57.878125 31.42549 \nL 60.929688 30.936961 \nL 63.98125 30.458301 \nL 67.032813 29.98951 \nL 70.084375 29.530588 \nL 71.291587 29.352941 \nL 73.135938 29.100254 \nL 76.1875 28.691359 \nL 79.239063 28.291653 \nL 82.290625 27.901136 \nL 85.342188 27.519807 \nL 88.39375 27.147667 \nL 91.445313 26.784716 \nL 92.277557 26.688235 \nL 94.496875 26.447552 \nL 97.548438 26.125209 \nL 100.6 25.811461 \nL 103.651563 25.506309 \nL 106.703125 25.209753 \nL 109.754688 24.921793 \nL 112.80625 24.642429 \nL 115.857813 24.37166 \nL 118.909375 24.109488 \nL 119.943803 24.023529 \nL 121.960938 23.86607 \nL 125.0125 23.635936 \nL 128.064063 23.413877 \nL 131.115625 23.199893 \nL 134.167188 22.993984 \nL 137.21875 22.79615 \nL 140.270313 22.60639 \nL 143.321875 22.424706 \nL 146.373438 22.251096 \nL 149.425 22.085561 \nL 152.476563 21.928102 \nL 155.528125 21.778717 \nL 158.579688 21.637406 \nL 161.63125 21.504171 \nL 164.682813 21.379011 \nL 165.208944 21.358824 \nL 167.734375 21.267462 \nL 170.785938 21.164681 \nL 173.8375 21.069513 \nL 176.889063 20.981958 \nL 179.940625 20.902017 \nL 182.992188 20.829689 \nL 186.04375 20.764975 \nL 189.095313 20.707874 \nL 192.146875 20.658387 \nL 195.198438 20.616513 \nL 198.25 20.582252 \nL 201.301563 20.555605 \nL 204.353125 20.536571 \nL 207.404688 20.525151 \nL 210.45625 20.521345 \nL 213.507813 20.525151 \nL 216.559375 20.536571 \nL 219.610938 20.555605 \nL 222.6625 20.582252 \nL 225.714063 20.616513 \nL 228.765625 20.658387 \nL 231.817188 20.707874 \nL 234.86875 20.764975 \nL 237.920313 20.829689 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_3\">\n    <path clip-path=\"url(#pd53dd10434)\" d=\"M 237.920313 122.924398 \nL 234.86875 122.977073 \nL 231.817188 123.02355 \nL 228.765625 123.06383 \nL 225.714063 123.097914 \nL 222.6625 123.1258 \nL 219.610938 123.14749 \nL 216.559375 123.162982 \nL 213.507813 123.172278 \nL 210.45625 123.175376 \nL 207.404688 123.172278 \nL 204.353125 123.162982 \nL 201.301563 123.14749 \nL 198.25 123.1258 \nL 195.198438 123.097914 \nL 192.146875 123.06383 \nL 189.095313 123.02355 \nL 186.04375 122.977073 \nL 182.992188 122.924398 \nL 179.940625 122.865527 \nL 176.889063 122.800458 \nL 173.8375 122.729193 \nL 170.785938 122.651731 \nL 169.542708 122.617647 \nL 167.734375 122.565653 \nL 164.682813 122.471413 \nL 161.63125 122.370674 \nL 158.579688 122.263436 \nL 155.528125 122.149699 \nL 152.476563 122.029462 \nL 149.425 121.902726 \nL 146.373438 121.769491 \nL 143.321875 121.629756 \nL 140.270313 121.483522 \nL 137.21875 121.330789 \nL 134.167188 121.171557 \nL 131.115625 121.005825 \nL 128.064063 120.833594 \nL 125.0125 120.654864 \nL 121.960938 120.469634 \nL 118.909375 120.277905 \nL 115.857813 120.079677 \nL 113.96875 119.952941 \nL 112.80625 119.87095 \nL 109.754688 119.648891 \nL 106.703125 119.42 \nL 103.651563 119.184276 \nL 100.6 118.941719 \nL 97.548438 118.69233 \nL 94.496875 118.436109 \nL 91.445313 118.173054 \nL 88.39375 117.903167 \nL 85.342188 117.626448 \nL 82.290625 117.342896 \nL 81.716213 117.288235 \nL 79.239063 117.039769 \nL 76.1875 116.726486 \nL 73.135938 116.406002 \nL 70.084375 116.078315 \nL 67.032813 115.743426 \nL 63.98125 115.401335 \nL 60.929688 115.052043 \nL 57.878125 114.695548 \nL 57.273855 114.623529 \nL 54.826563 114.315185 \nL 51.775 113.923092 \nL 48.723438 113.523387 \nL 45.671875 113.116067 \nL 42.620313 112.701134 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#pd53dd10434)\" d=\"M 42.620313 20.616513 \nL 45.671875 20.20158 \nL 48.723438 19.794261 \nL 51.775 19.394555 \nL 54.826563 19.002462 \nL 57.273855 18.694118 \nL 57.878125 18.622099 \nL 60.929688 18.265604 \nL 63.98125 17.916312 \nL 67.032813 17.574221 \nL 70.084375 17.239332 \nL 73.135938 16.911645 \nL 76.1875 16.591161 \nL 79.239063 16.277878 \nL 81.716213 16.029412 \nL 82.290625 15.974751 \nL 85.342188 15.691199 \nL 88.39375 15.41448 \nL 91.445313 15.144593 \nL 94.496875 14.881538 \nL 97.548438 14.625317 \nL 100.6 14.375928 \nL 103.651563 14.133371 \nL 106.703125 13.897647 \nL 109.754688 13.668756 \nL 112.80625 13.446697 \nL 113.96875 13.364706 \nL 115.857813 13.23797 \nL 118.909375 13.039742 \nL 121.960938 12.848013 \nL 125.0125 12.662783 \nL 128.064063 12.484053 \nL 131.115625 12.311822 \nL 134.167188 12.14609 \nL 137.21875 11.986858 \nL 140.270313 11.834125 \nL 143.321875 11.687891 \nL 146.373438 11.548156 \nL 149.425 11.414921 \nL 152.476563 11.288185 \nL 155.528125 11.167948 \nL 158.579688 11.054211 \nL 161.63125 10.946973 \nL 164.682813 10.846234 \nL 167.734375 10.751994 \nL 169.542708 10.7 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_4\">\n    <path clip-path=\"url(#pd53dd10434)\" d=\"M 237.920313 131.696681 \nL 234.86875 131.742905 \nL 231.817188 131.783691 \nL 228.765625 131.81904 \nL 225.714063 131.84895 \nL 222.6625 131.873421 \nL 219.610938 131.892455 \nL 216.559375 131.90605 \nL 213.507813 131.914208 \nL 210.45625 131.916927 \nL 207.404688 131.914208 \nL 204.353125 131.90605 \nL 201.301563 131.892455 \nL 198.25 131.873421 \nL 195.198438 131.84895 \nL 192.146875 131.81904 \nL 189.095313 131.783691 \nL 186.04375 131.742905 \nL 182.992188 131.696681 \nL 179.940625 131.645018 \nL 176.889063 131.587917 \nL 173.8375 131.525378 \nL 170.785938 131.457401 \nL 167.734375 131.383986 \nL 164.682813 131.305132 \nL 161.63125 131.22084 \nL 158.579688 131.13111 \nL 155.528125 131.035942 \nL 152.476563 130.935336 \nL 149.425 130.829292 \nL 146.373438 130.717809 \nL 143.605741 130.611765 \nL 143.321875 130.600426 \nL 140.270313 130.47286 \nL 137.21875 130.339625 \nL 134.167188 130.20072 \nL 131.115625 130.056145 \nL 128.064063 129.905901 \nL 125.0125 129.749987 \nL 121.960938 129.588404 \nL 118.909375 129.421151 \nL 115.857813 129.248229 \nL 112.80625 129.069637 \nL 109.754688 128.885375 \nL 106.703125 128.695444 \nL 103.651563 128.499844 \nL 100.6 128.298573 \nL 97.548438 128.091633 \nL 95.473375 127.947059 \nL 94.496875 127.876 \nL 91.445313 127.64802 \nL 88.39375 127.414118 \nL 85.342188 127.174294 \nL 82.290625 126.928549 \nL 79.239063 126.676882 \nL 76.1875 126.419294 \nL 73.135938 126.155784 \nL 70.084375 125.886353 \nL 67.032813 125.611 \nL 63.98125 125.329725 \nL 63.477899 125.282353 \nL 60.929688 125.031375 \nL 57.878125 124.724624 \nL 54.826563 124.411676 \nL 51.775 124.092531 \nL 48.723438 123.767189 \nL 45.671875 123.43565 \nL 42.620313 123.097914 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_5\">\n    <path clip-path=\"url(#pd53dd10434)\" d=\"M 237.920313 139.427096 \nL 234.86875 139.468278 \nL 231.817188 139.504615 \nL 228.765625 139.536107 \nL 225.714063 139.562754 \nL 222.6625 139.584556 \nL 219.610938 139.601513 \nL 216.559375 139.613626 \nL 213.507813 139.620893 \nL 210.45625 139.623316 \nL 207.404688 139.620893 \nL 204.353125 139.613626 \nL 201.301563 139.601513 \nL 198.25 139.584556 \nL 195.198438 139.562754 \nL 192.146875 139.536107 \nL 189.095313 139.504615 \nL 186.04375 139.468278 \nL 182.992188 139.427096 \nL 179.940625 139.38107 \nL 176.889063 139.330198 \nL 173.8375 139.274481 \nL 170.785938 139.21392 \nL 167.734375 139.148513 \nL 164.682813 139.078262 \nL 161.63125 139.003166 \nL 158.579688 138.923225 \nL 155.528125 138.838439 \nL 152.476563 138.748807 \nL 149.425 138.654332 \nL 147.936433 138.605882 \nL 146.373438 138.553091 \nL 143.321875 138.444994 \nL 140.270313 138.33187 \nL 137.21875 138.213718 \nL 134.167188 138.090538 \nL 131.115625 137.962331 \nL 128.064063 137.829095 \nL 125.0125 137.690832 \nL 121.960938 137.547542 \nL 118.909375 137.399223 \nL 115.857813 137.245877 \nL 112.80625 137.087503 \nL 109.754688 136.924101 \nL 106.703125 136.755671 \nL 103.651563 136.582214 \nL 100.6 136.403729 \nL 97.548438 136.220216 \nL 94.496875 136.031676 \nL 93.07017 135.941176 \nL 91.445313 135.834066 \nL 88.39375 135.627682 \nL 85.342188 135.416073 \nL 82.290625 135.199239 \nL 79.239063 134.97718 \nL 76.1875 134.749896 \nL 73.135938 134.517388 \nL 70.084375 134.279654 \nL 67.032813 134.036696 \nL 63.98125 133.788512 \nL 60.929688 133.535104 \nL 57.878125 133.276471 \nL 57.878125 133.276471 \nL 54.826563 133.001843 \nL 51.775 132.721777 \nL 48.723438 132.436273 \nL 45.671875 132.14533 \nL 42.620313 131.84895 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_6\">\n    <path clip-path=\"url(#pd53dd10434)\" d=\"M 210.45625 146.6 \nL 207.404688 146.597742 \nL 204.353125 146.590967 \nL 201.301563 146.579676 \nL 198.25 146.563868 \nL 195.198438 146.543544 \nL 192.146875 146.518704 \nL 189.095313 146.489347 \nL 186.04375 146.455474 \nL 182.992188 146.417084 \nL 179.940625 146.374177 \nL 176.889063 146.326755 \nL 173.8375 146.274816 \nL 170.785938 146.21836 \nL 167.734375 146.157388 \nL 164.682813 146.091899 \nL 161.63125 146.021894 \nL 158.579688 145.947373 \nL 155.528125 145.868335 \nL 152.476563 145.784781 \nL 149.425 145.69671 \nL 146.373438 145.604123 \nL 143.321875 145.507019 \nL 140.270313 145.405399 \nL 137.21875 145.299262 \nL 134.167188 145.188609 \nL 131.115625 145.07344 \nL 128.064063 144.953754 \nL 125.0125 144.829551 \nL 121.960938 144.700833 \nL 118.909375 144.567597 \nL 115.857813 144.429845 \nL 112.80625 144.287577 \nL 109.754688 144.140793 \nL 106.703125 143.989492 \nL 105.641712 143.935294 \nL 103.651563 143.830108 \nL 100.6 143.664149 \nL 97.548438 143.493514 \nL 94.496875 143.318204 \nL 91.445313 143.13822 \nL 88.39375 142.95356 \nL 85.342188 142.764226 \nL 82.290625 142.570217 \nL 79.239063 142.371533 \nL 76.1875 142.168173 \nL 73.135938 141.960139 \nL 70.084375 141.74743 \nL 67.032813 141.530046 \nL 63.98125 141.307988 \nL 63.477899 141.270588 \nL 60.929688 141.074369 \nL 57.878125 140.834545 \nL 54.826563 140.589877 \nL 51.775 140.340364 \nL 48.723438 140.086005 \nL 45.671875 139.826802 \nL 42.620313 139.562754 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#pd53dd10434)\" d=\"M 237.920313 146.417084 \nL 234.86875 146.455474 \nL 231.817188 146.489347 \nL 228.765625 146.518704 \nL 225.714063 146.543544 \nL 222.6625 146.563868 \nL 219.610938 146.579676 \nL 216.559375 146.590967 \nL 213.507813 146.597742 \nL 210.45625 146.6 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_7\">\n    <path clip-path=\"url(#pd53dd10434)\" d=\"M 43.320212 146.6 \nL 42.620313 146.543544 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"line2d_10\">\n    <path clip-path=\"url(#pd53dd10434)\" d=\"M 57.878125 119.952941 \nL 70.084375 34.682353 \nL 87.41725 43.209412 \nL 105.926808 84.992 \nL 123.543942 76.550212 \nL 139.305493 56.503096 \nL 152.87833 62.728702 \nL 164.270982 72.129699 \nL 173.662129 68.076797 \nL 181.301232 63.781588 \nL 187.453185 66.23756 \nL 192.369407 68.139567 \nL 196.274465 66.721381 \nL 199.361537 65.912196 \nL 201.79265 66.702208 \nL 203.701295 67.027799 \nL 205.196013 66.600234 \nL 206.364192 66.480195 \nL 207.275645 66.705981 \nL 207.985821 66.743422 \nL 208.538543 66.626785 \n\" style=\"fill:none;stroke:#ff7f0e;stroke-linecap:square;stroke-width:1.5;\"/>\n    <defs>\n     <path d=\"M 0 3 \nC 0.795609 3 1.55874 2.683901 2.12132 2.12132 \nC 2.683901 1.55874 3 0.795609 3 0 \nC 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 \nC 1.55874 -2.683901 0.795609 -3 0 -3 \nC -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 \nC -2.683901 -1.55874 -3 -0.795609 -3 0 \nC -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 \nC -1.55874 2.683901 -0.795609 3 0 3 \nz\n\" id=\"ma2029f00db\" style=\"stroke:#ff7f0e;\"/>\n    </defs>\n    <g clip-path=\"url(#pd53dd10434)\">\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"57.878125\" xlink:href=\"#ma2029f00db\" y=\"119.952941\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"70.084375\" xlink:href=\"#ma2029f00db\" y=\"34.682353\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"87.41725\" xlink:href=\"#ma2029f00db\" y=\"43.209412\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"105.926808\" xlink:href=\"#ma2029f00db\" y=\"84.992\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"123.543942\" xlink:href=\"#ma2029f00db\" y=\"76.550212\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"139.305493\" xlink:href=\"#ma2029f00db\" y=\"56.503096\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"152.87833\" xlink:href=\"#ma2029f00db\" y=\"62.728702\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"164.270982\" xlink:href=\"#ma2029f00db\" y=\"72.129699\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"173.662129\" xlink:href=\"#ma2029f00db\" y=\"68.076797\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"181.301232\" xlink:href=\"#ma2029f00db\" y=\"63.781588\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"187.453185\" xlink:href=\"#ma2029f00db\" y=\"66.23756\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"192.369407\" xlink:href=\"#ma2029f00db\" y=\"68.139567\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"196.274465\" xlink:href=\"#ma2029f00db\" y=\"66.721381\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"199.361537\" xlink:href=\"#ma2029f00db\" y=\"65.912196\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"201.79265\" xlink:href=\"#ma2029f00db\" y=\"66.702208\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"203.701295\" xlink:href=\"#ma2029f00db\" y=\"67.027799\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"205.196013\" xlink:href=\"#ma2029f00db\" y=\"66.600234\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"206.364192\" xlink:href=\"#ma2029f00db\" y=\"66.480195\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"207.275645\" xlink:href=\"#ma2029f00db\" y=\"66.705981\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"207.985821\" xlink:href=\"#ma2029f00db\" y=\"66.743422\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"208.538543\" xlink:href=\"#ma2029f00db\" y=\"66.626785\"/>\n    </g>\n   </g>\n   <g id=\"patch_3\">\n    <path d=\"M 42.620312 146.6 \nL 42.620312 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_4\">\n    <path d=\"M 237.920313 146.6 \nL 237.920313 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_5\">\n    <path d=\"M 42.620313 146.6 \nL 237.920313 146.6 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_6\">\n    <path d=\"M 42.620313 10.7 \nL 237.920313 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n  </g>\n </g>\n <defs>\n  <clipPath id=\"pd53dd10434\">\n   <rect height=\"135.9\" width=\"195.3\" x=\"42.620312\" y=\"10.7\"/>\n  </clipPath>\n </defs>\n</svg>\n",
   "text/plain": "<Figure size 252x180 with 1 Axes>"
  },
  "metadata": {},
  "output_type": "display_data"
 }
]
```

可以看到使用较小的学习率$\eta=0.4$和动量超参数$\gamma=0.5$时，动量法在竖直方向上的移动更加平滑，且在水平方向上更快逼近最优解。我们还发现，使用较大的学习率$\eta=0.6$时，自变量也不再发散。

```{.python .input  n=5}
eta = 0.6
gb.show_trace_2d(f_2d, gb.train_2d(momentum_2d))
```

```{.json .output n=5}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "epoch 20, x1 0.007188, x2 0.002553\n"
 },
 {
  "data": {
   "image/svg+xml": "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n  \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Created with matplotlib (http://matplotlib.org/) -->\n<svg height=\"184.15625pt\" version=\"1.1\" viewBox=\"0 0 248.620313 184.15625\" width=\"248.620313pt\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n <defs>\n  <style type=\"text/css\">\n*{stroke-linecap:butt;stroke-linejoin:round;}\n  </style>\n </defs>\n <g id=\"figure_1\">\n  <g id=\"patch_1\">\n   <path d=\"M 0 184.15625 \nL 248.620313 184.15625 \nL 248.620313 -0 \nL 0 -0 \nz\n\" style=\"fill:none;\"/>\n  </g>\n  <g id=\"axes_1\">\n   <g id=\"patch_2\">\n    <path d=\"M 42.620312 146.6 \nL 237.920313 146.6 \nL 237.920313 10.7 \nL 42.620312 10.7 \nz\n\" style=\"fill:#ffffff;\"/>\n   </g>\n   <g id=\"matplotlib.axis_1\">\n    <g id=\"xtick_1\">\n     <g id=\"line2d_1\">\n      <defs>\n       <path d=\"M 0 0 \nL 0 3.5 \n\" id=\"m93f5dc9b10\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"88.39375\" xlink:href=\"#m93f5dc9b10\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_1\">\n      <!-- \u22124 -->\n      <defs>\n       <path d=\"M 10.59375 35.5 \nL 73.1875 35.5 \nL 73.1875 27.203125 \nL 10.59375 27.203125 \nz\n\" id=\"DejaVuSans-2212\"/>\n       <path d=\"M 37.796875 64.3125 \nL 12.890625 25.390625 \nL 37.796875 25.390625 \nz\nM 35.203125 72.90625 \nL 47.609375 72.90625 \nL 47.609375 25.390625 \nL 58.015625 25.390625 \nL 58.015625 17.1875 \nL 47.609375 17.1875 \nL 47.609375 0 \nL 37.796875 0 \nL 37.796875 17.1875 \nL 4.890625 17.1875 \nL 4.890625 26.703125 \nz\n\" id=\"DejaVuSans-34\"/>\n      </defs>\n      <g transform=\"translate(81.022656 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-34\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_2\">\n     <g id=\"line2d_2\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"149.425\" xlink:href=\"#m93f5dc9b10\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_2\">\n      <!-- \u22122 -->\n      <defs>\n       <path d=\"M 19.1875 8.296875 \nL 53.609375 8.296875 \nL 53.609375 0 \nL 7.328125 0 \nL 7.328125 8.296875 \nQ 12.9375 14.109375 22.625 23.890625 \nQ 32.328125 33.6875 34.8125 36.53125 \nQ 39.546875 41.84375 41.421875 45.53125 \nQ 43.3125 49.21875 43.3125 52.78125 \nQ 43.3125 58.59375 39.234375 62.25 \nQ 35.15625 65.921875 28.609375 65.921875 \nQ 23.96875 65.921875 18.8125 64.3125 \nQ 13.671875 62.703125 7.8125 59.421875 \nL 7.8125 69.390625 \nQ 13.765625 71.78125 18.9375 73 \nQ 24.125 74.21875 28.421875 74.21875 \nQ 39.75 74.21875 46.484375 68.546875 \nQ 53.21875 62.890625 53.21875 53.421875 \nQ 53.21875 48.921875 51.53125 44.890625 \nQ 49.859375 40.875 45.40625 35.40625 \nQ 44.1875 33.984375 37.640625 27.21875 \nQ 31.109375 20.453125 19.1875 8.296875 \nz\n\" id=\"DejaVuSans-32\"/>\n      </defs>\n      <g transform=\"translate(142.053906 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-32\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_3\">\n     <g id=\"line2d_3\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"210.45625\" xlink:href=\"#m93f5dc9b10\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_3\">\n      <!-- 0 -->\n      <defs>\n       <path d=\"M 31.78125 66.40625 \nQ 24.171875 66.40625 20.328125 58.90625 \nQ 16.5 51.421875 16.5 36.375 \nQ 16.5 21.390625 20.328125 13.890625 \nQ 24.171875 6.390625 31.78125 6.390625 \nQ 39.453125 6.390625 43.28125 13.890625 \nQ 47.125 21.390625 47.125 36.375 \nQ 47.125 51.421875 43.28125 58.90625 \nQ 39.453125 66.40625 31.78125 66.40625 \nz\nM 31.78125 74.21875 \nQ 44.046875 74.21875 50.515625 64.515625 \nQ 56.984375 54.828125 56.984375 36.375 \nQ 56.984375 17.96875 50.515625 8.265625 \nQ 44.046875 -1.421875 31.78125 -1.421875 \nQ 19.53125 -1.421875 13.0625 8.265625 \nQ 6.59375 17.96875 6.59375 36.375 \nQ 6.59375 54.828125 13.0625 64.515625 \nQ 19.53125 74.21875 31.78125 74.21875 \nz\n\" id=\"DejaVuSans-30\"/>\n      </defs>\n      <g transform=\"translate(207.275 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_4\">\n     <!-- x1 -->\n     <defs>\n      <path d=\"M 54.890625 54.6875 \nL 35.109375 28.078125 \nL 55.90625 0 \nL 45.3125 0 \nL 29.390625 21.484375 \nL 13.484375 0 \nL 2.875 0 \nL 24.125 28.609375 \nL 4.6875 54.6875 \nL 15.28125 54.6875 \nL 29.78125 35.203125 \nL 44.28125 54.6875 \nz\n\" id=\"DejaVuSans-78\"/>\n      <path d=\"M 12.40625 8.296875 \nL 28.515625 8.296875 \nL 28.515625 63.921875 \nL 10.984375 60.40625 \nL 10.984375 69.390625 \nL 28.421875 72.90625 \nL 38.28125 72.90625 \nL 38.28125 8.296875 \nL 54.390625 8.296875 \nL 54.390625 0 \nL 12.40625 0 \nz\n\" id=\"DejaVuSans-31\"/>\n     </defs>\n     <g transform=\"translate(134.129687 174.876562)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-78\"/>\n      <use x=\"59.179688\" xlink:href=\"#DejaVuSans-31\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"matplotlib.axis_2\">\n    <g id=\"ytick_1\">\n     <g id=\"line2d_4\">\n      <defs>\n       <path d=\"M 0 0 \nL -3.5 0 \n\" id=\"m1d77b95d30\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#m1d77b95d30\" y=\"126.316418\"/>\n      </g>\n     </g>\n     <g id=\"text_5\">\n      <!-- \u22122 -->\n      <g transform=\"translate(20.878125 130.115637)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-2212\"/>\n       <use x=\"83.789062\" xlink:href=\"#DejaVuSans-32\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_2\">\n     <g id=\"line2d_5\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#m1d77b95d30\" y=\"85.749254\"/>\n      </g>\n     </g>\n     <g id=\"text_6\">\n      <!-- 0 -->\n      <g transform=\"translate(29.257812 89.548472)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_3\">\n     <g id=\"line2d_6\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"42.620312\" xlink:href=\"#m1d77b95d30\" y=\"45.18209\"/>\n      </g>\n     </g>\n     <g id=\"text_7\">\n      <!-- 2 -->\n      <g transform=\"translate(29.257812 48.981308)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-32\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_8\">\n     <!-- x2 -->\n     <g transform=\"translate(14.798437 84.790625)rotate(-90)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-78\"/>\n      <use x=\"59.179688\" xlink:href=\"#DejaVuSans-32\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"LineCollection_1\">\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 237.920313 114.142512 \nL 237.740809 114.146269 \nL 234.86875 114.202223 \nL 231.817188 114.254681 \nL 228.765625 114.300144 \nL 225.714063 114.338613 \nL 222.6625 114.370087 \nL 219.610938 114.394568 \nL 216.559375 114.412054 \nL 213.507813 114.422545 \nL 210.45625 114.426042 \nL 207.404688 114.422545 \nL 204.353125 114.412054 \nL 201.301563 114.394568 \nL 198.25 114.370087 \nL 195.198438 114.338613 \nL 192.146875 114.300144 \nL 189.095313 114.254681 \nL 186.04375 114.202223 \nL 183.171691 114.146269 \nL 182.992188 114.142512 \nL 179.940625 114.071144 \nL 176.889063 113.992264 \nL 173.8375 113.905871 \nL 170.785938 113.811965 \nL 167.734375 113.710547 \nL 164.682813 113.601617 \nL 161.63125 113.485174 \nL 158.579688 113.361219 \nL 155.528125 113.229751 \nL 152.476563 113.090771 \nL 149.425 112.944279 \nL 146.373438 112.790274 \nL 143.321875 112.628756 \nL 140.270313 112.459726 \nL 137.21875 112.283184 \nL 134.478571 112.11791 \nL 134.167188 112.097627 \nL 131.115625 111.890734 \nL 128.064063 111.675728 \nL 125.0125 111.452609 \nL 121.960938 111.221376 \nL 118.909375 110.98203 \nL 115.857813 110.73457 \nL 112.80625 110.478997 \nL 109.754688 110.21531 \nL 108.342771 110.089552 \nL 106.703125 109.930811 \nL 103.651563 109.626557 \nL 100.6 109.313485 \nL 97.548438 108.991593 \nL 94.496875 108.660883 \nL 91.445313 108.321353 \nL 89.166297 108.061194 \nL 88.39375 107.964606 \nL 85.342188 107.573422 \nL 82.290625 107.17258 \nL 79.239063 106.762079 \nL 76.1875 106.341919 \nL 73.993118 106.032836 \nL 73.135938 105.899391 \nL 70.084375 105.413653 \nL 67.032813 104.917239 \nL 63.98125 104.410149 \nL 61.590335 104.004478 \nL 60.929688 103.879197 \nL 57.878125 103.288586 \nL 54.826563 102.686045 \nL 51.775 102.071572 \nL 51.31 101.976119 \nL 48.723438 101.374373 \nL 45.671875 100.650925 \nL 42.760292 99.947761 \nL 42.620313 99.908754 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 42.620313 71.589753 \nL 42.760292 71.550746 \nL 45.671875 70.847582 \nL 48.723438 70.124134 \nL 51.31 69.522388 \nL 51.775 69.426936 \nL 54.826563 68.812463 \nL 57.878125 68.209921 \nL 60.929688 67.619311 \nL 61.590335 67.49403 \nL 63.98125 67.088358 \nL 67.032813 66.581269 \nL 70.084375 66.084855 \nL 73.135938 65.599116 \nL 73.993118 65.465672 \nL 76.1875 65.156588 \nL 79.239063 64.736429 \nL 82.290625 64.325928 \nL 85.342188 63.925085 \nL 88.39375 63.533902 \nL 89.166297 63.437313 \nL 91.445313 63.177154 \nL 94.496875 62.837625 \nL 97.548438 62.506914 \nL 100.6 62.185023 \nL 103.651563 61.87195 \nL 106.703125 61.567696 \nL 108.342771 61.408955 \nL 109.754688 61.283197 \nL 112.80625 61.01951 \nL 115.857813 60.763937 \nL 118.909375 60.516478 \nL 121.960938 60.277131 \nL 125.0125 60.045899 \nL 128.064063 59.822779 \nL 131.115625 59.607773 \nL 134.167188 59.400881 \nL 134.478571 59.380597 \nL 137.21875 59.215323 \nL 140.270313 59.038781 \nL 143.321875 58.869751 \nL 146.373438 58.708234 \nL 149.425 58.554229 \nL 152.476563 58.407736 \nL 155.528125 58.268756 \nL 158.579688 58.137289 \nL 161.63125 58.013333 \nL 164.682813 57.896891 \nL 167.734375 57.78796 \nL 170.785938 57.686542 \nL 173.8375 57.592637 \nL 176.889063 57.506244 \nL 179.940625 57.427363 \nL 182.992188 57.355995 \nL 183.171691 57.352239 \nL 186.04375 57.296284 \nL 189.095313 57.243827 \nL 192.146875 57.198363 \nL 195.198438 57.159894 \nL 198.25 57.12842 \nL 201.301563 57.10394 \nL 204.353125 57.086454 \nL 207.404688 57.075962 \nL 210.45625 57.072465 \nL 213.507813 57.075962 \nL 216.559375 57.086454 \nL 219.610938 57.10394 \nL 222.6625 57.12842 \nL 225.714063 57.159894 \nL 228.765625 57.198363 \nL 231.817188 57.243827 \nL 234.86875 57.296284 \nL 237.740809 57.352239 \nL 237.920313 57.355995 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_2\">\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 237.920313 126.105781 \nL 234.86875 126.149989 \nL 231.817188 126.188995 \nL 228.765625 126.222801 \nL 225.714063 126.251406 \nL 222.6625 126.274811 \nL 219.610938 126.293014 \nL 216.559375 126.306016 \nL 213.507813 126.313817 \nL 210.45625 126.316418 \nL 210.45625 126.316418 \nL 210.45625 126.316418 \nL 207.404688 126.313817 \nL 204.353125 126.306016 \nL 201.301563 126.293014 \nL 198.25 126.274811 \nL 195.198438 126.251406 \nL 192.146875 126.222801 \nL 189.095313 126.188995 \nL 186.04375 126.149989 \nL 182.992188 126.105781 \nL 179.940625 126.056372 \nL 176.889063 126.001762 \nL 173.8375 125.941952 \nL 170.785938 125.87694 \nL 167.734375 125.806728 \nL 164.682813 125.731315 \nL 161.63125 125.6507 \nL 158.579688 125.564885 \nL 155.528125 125.473869 \nL 152.476563 125.377652 \nL 149.425 125.276234 \nL 146.373438 125.169615 \nL 143.321875 125.057796 \nL 140.270313 124.940775 \nL 137.21875 124.818553 \nL 134.167188 124.691131 \nL 131.115625 124.558507 \nL 128.064063 124.420683 \nL 125.234432 124.28806 \nL 125.0125 124.277096 \nL 121.960938 124.120857 \nL 118.909375 123.959137 \nL 115.857813 123.791934 \nL 112.80625 123.61925 \nL 109.754688 123.441083 \nL 106.703125 123.257434 \nL 103.651563 123.068304 \nL 100.6 122.873691 \nL 97.548438 122.673596 \nL 94.496875 122.468019 \nL 91.484943 122.259701 \nL 91.445313 122.256804 \nL 88.39375 122.027889 \nL 85.342188 121.793179 \nL 82.290625 121.552674 \nL 79.239063 121.306373 \nL 76.1875 121.054277 \nL 73.135938 120.796386 \nL 70.084375 120.532699 \nL 67.032813 120.263217 \nL 66.679474 120.231343 \nL 63.98125 119.973189 \nL 60.929688 119.675081 \nL 57.878125 119.370828 \nL 54.826563 119.060427 \nL 51.775 118.743881 \nL 48.723438 118.421187 \nL 46.698569 118.202985 \nL 45.671875 118.085209 \nL 42.620313 117.728611 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 42.620313 53.769896 \nL 45.671875 53.413298 \nL 46.698569 53.295522 \nL 48.723438 53.07732 \nL 51.775 52.754627 \nL 54.826563 52.43808 \nL 57.878125 52.12768 \nL 60.929688 51.823426 \nL 63.98125 51.525319 \nL 66.679474 51.267164 \nL 67.032813 51.23529 \nL 70.084375 50.965808 \nL 73.135938 50.702122 \nL 76.1875 50.44423 \nL 79.239063 50.192134 \nL 82.290625 49.945834 \nL 85.342188 49.705328 \nL 88.39375 49.470618 \nL 91.445313 49.241704 \nL 91.484943 49.238806 \nL 94.496875 49.030488 \nL 97.548438 48.824911 \nL 100.6 48.624816 \nL 103.651563 48.430204 \nL 106.703125 48.241073 \nL 109.754688 48.057424 \nL 112.80625 47.879258 \nL 115.857813 47.706573 \nL 118.909375 47.539371 \nL 121.960938 47.37765 \nL 125.0125 47.221412 \nL 125.234432 47.210448 \nL 128.064063 47.077824 \nL 131.115625 46.94 \nL 134.167188 46.807377 \nL 137.21875 46.679954 \nL 140.270313 46.557732 \nL 143.321875 46.440712 \nL 146.373438 46.328892 \nL 149.425 46.222273 \nL 152.476563 46.120855 \nL 155.528125 46.024638 \nL 158.579688 45.933622 \nL 161.63125 45.847807 \nL 164.682813 45.767193 \nL 167.734375 45.69178 \nL 170.785938 45.621567 \nL 173.8375 45.556556 \nL 176.889063 45.496745 \nL 179.940625 45.442135 \nL 182.992188 45.392727 \nL 186.04375 45.348519 \nL 189.095313 45.309512 \nL 192.146875 45.275706 \nL 195.198438 45.247101 \nL 198.25 45.223697 \nL 201.301563 45.205494 \nL 204.353125 45.192491 \nL 207.404688 45.18469 \nL 210.45625 45.18209 \nL 213.507813 45.18469 \nL 216.559375 45.192491 \nL 219.610938 45.205494 \nL 222.6625 45.223697 \nL 225.714063 45.247101 \nL 228.765625 45.275706 \nL 231.817188 45.309512 \nL 234.86875 45.348519 \nL 237.920313 45.392727 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_3\">\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 237.920313 135.255682 \nL 234.86875 135.290868 \nL 231.817188 135.321914 \nL 228.765625 135.348821 \nL 225.714063 135.371588 \nL 222.6625 135.390216 \nL 219.610938 135.404705 \nL 216.559375 135.415053 \nL 213.507813 135.421263 \nL 210.45625 135.423332 \nL 207.404688 135.421263 \nL 204.353125 135.415053 \nL 201.301563 135.404705 \nL 198.25 135.390216 \nL 195.198438 135.371588 \nL 192.146875 135.348821 \nL 189.095313 135.321914 \nL 186.04375 135.290868 \nL 182.992188 135.255682 \nL 179.940625 135.216357 \nL 176.889063 135.172892 \nL 173.8375 135.125288 \nL 170.785938 135.073544 \nL 167.734375 135.017661 \nL 164.682813 134.957638 \nL 161.63125 134.893475 \nL 158.579688 134.825174 \nL 155.528125 134.752732 \nL 152.476563 134.676151 \nL 149.425 134.595431 \nL 146.373438 134.510571 \nL 143.605741 134.429851 \nL 143.321875 134.421219 \nL 140.270313 134.324117 \nL 137.21875 134.222699 \nL 134.167188 134.116966 \nL 131.115625 134.006916 \nL 128.064063 133.892552 \nL 125.0125 133.773871 \nL 121.960938 133.650875 \nL 118.909375 133.523563 \nL 115.857813 133.391936 \nL 112.80625 133.255992 \nL 109.754688 133.115734 \nL 106.703125 132.971159 \nL 103.651563 132.822269 \nL 100.6 132.669063 \nL 97.548438 132.511542 \nL 95.473375 132.401493 \nL 94.496875 132.347403 \nL 91.445313 132.173866 \nL 88.39375 131.995821 \nL 85.342188 131.813269 \nL 82.290625 131.626209 \nL 79.239063 131.434642 \nL 76.1875 131.238567 \nL 73.135938 131.037985 \nL 70.084375 130.832896 \nL 67.032813 130.623299 \nL 63.98125 130.409194 \nL 63.477899 130.373134 \nL 60.929688 130.182091 \nL 57.878125 129.948594 \nL 54.826563 129.71038 \nL 51.775 129.467449 \nL 48.723438 129.2198 \nL 45.671875 128.967435 \nL 42.620313 128.710352 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 42.620313 42.788155 \nL 45.671875 42.531073 \nL 48.723438 42.278707 \nL 51.775 42.031059 \nL 54.826563 41.788127 \nL 57.878125 41.549913 \nL 60.929688 41.316416 \nL 63.477899 41.125373 \nL 63.98125 41.089313 \nL 67.032813 40.875209 \nL 70.084375 40.665612 \nL 73.135938 40.460522 \nL 76.1875 40.25994 \nL 79.239063 40.063866 \nL 82.290625 39.872299 \nL 85.342188 39.685239 \nL 88.39375 39.502687 \nL 91.445313 39.324642 \nL 94.496875 39.151104 \nL 95.473375 39.097015 \nL 97.548438 38.986966 \nL 100.6 38.829444 \nL 103.651563 38.676238 \nL 106.703125 38.527348 \nL 109.754688 38.382774 \nL 112.80625 38.242515 \nL 115.857813 38.106572 \nL 118.909375 37.974944 \nL 121.960938 37.847633 \nL 125.0125 37.724636 \nL 128.064063 37.605956 \nL 131.115625 37.491591 \nL 134.167188 37.381542 \nL 137.21875 37.275808 \nL 140.270313 37.17439 \nL 143.321875 37.077288 \nL 143.605741 37.068657 \nL 146.373438 36.987936 \nL 149.425 36.903076 \nL 152.476563 36.822356 \nL 155.528125 36.745775 \nL 158.579688 36.673334 \nL 161.63125 36.605032 \nL 164.682813 36.54087 \nL 167.734375 36.480847 \nL 170.785938 36.424963 \nL 173.8375 36.37322 \nL 176.889063 36.325615 \nL 179.940625 36.28215 \nL 182.992188 36.242825 \nL 186.04375 36.207639 \nL 189.095313 36.176593 \nL 192.146875 36.149686 \nL 195.198438 36.126919 \nL 198.25 36.108291 \nL 201.301563 36.093803 \nL 204.353125 36.083454 \nL 207.404688 36.077245 \nL 210.45625 36.075175 \nL 213.507813 36.077245 \nL 216.559375 36.083454 \nL 219.610938 36.093803 \nL 222.6625 36.108291 \nL 225.714063 36.126919 \nL 228.765625 36.149686 \nL 231.817188 36.176593 \nL 234.86875 36.207639 \nL 237.920313 36.242825 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_4\">\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 237.920313 142.968527 \nL 234.86875 142.998775 \nL 231.817188 143.025463 \nL 228.765625 143.048594 \nL 225.714063 143.068166 \nL 222.6625 143.084179 \nL 219.610938 143.096634 \nL 216.559375 143.10553 \nL 213.507813 143.110868 \nL 210.45625 143.112647 \nL 207.404688 143.110868 \nL 204.353125 143.10553 \nL 201.301563 143.096634 \nL 198.25 143.084179 \nL 195.198438 143.068166 \nL 192.146875 143.048594 \nL 189.095313 143.025463 \nL 186.04375 142.998775 \nL 182.992188 142.968527 \nL 179.940625 142.934721 \nL 176.889063 142.897357 \nL 173.8375 142.856434 \nL 170.785938 142.811952 \nL 167.734375 142.763912 \nL 164.682813 142.712313 \nL 161.63125 142.657156 \nL 158.579688 142.598441 \nL 155.876875 142.543284 \nL 155.528125 142.535908 \nL 152.476563 142.467681 \nL 149.425 142.395767 \nL 146.373438 142.320164 \nL 143.321875 142.240874 \nL 140.270313 142.157896 \nL 137.21875 142.071229 \nL 134.167188 141.980875 \nL 131.115625 141.886833 \nL 128.064063 141.789103 \nL 125.0125 141.687685 \nL 121.960938 141.582579 \nL 118.909375 141.473786 \nL 115.857813 141.361304 \nL 112.80625 141.245134 \nL 109.754688 141.125277 \nL 106.703125 141.001731 \nL 103.651563 140.874498 \nL 100.6 140.743577 \nL 97.548438 140.608967 \nL 95.473375 140.514925 \nL 94.496875 140.469 \nL 91.445313 140.321657 \nL 88.39375 140.170487 \nL 85.342188 140.01549 \nL 82.290625 139.856666 \nL 79.239063 139.694014 \nL 76.1875 139.527536 \nL 73.135938 139.35723 \nL 70.084375 139.183098 \nL 67.032813 139.005138 \nL 63.98125 138.823351 \nL 60.929688 138.637737 \nL 58.494602 138.486567 \nL 57.878125 138.446795 \nL 54.826563 138.245948 \nL 51.775 138.041124 \nL 48.723438 137.832322 \nL 45.671875 137.619543 \nL 42.620313 137.402788 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 42.620313 34.09572 \nL 45.671875 33.878964 \nL 48.723438 33.666185 \nL 51.775 33.457384 \nL 54.826563 33.252559 \nL 57.878125 33.051712 \nL 58.494602 33.01194 \nL 60.929688 32.86077 \nL 63.98125 32.675156 \nL 67.032813 32.493369 \nL 70.084375 32.31541 \nL 73.135938 32.141277 \nL 76.1875 31.970972 \nL 79.239063 31.804493 \nL 82.290625 31.641842 \nL 85.342188 31.483017 \nL 88.39375 31.32802 \nL 91.445313 31.17685 \nL 94.496875 31.029507 \nL 95.473375 30.983582 \nL 97.548438 30.88954 \nL 100.6 30.754931 \nL 103.651563 30.624009 \nL 106.703125 30.496776 \nL 109.754688 30.373231 \nL 112.80625 30.253373 \nL 115.857813 30.137204 \nL 118.909375 30.024722 \nL 121.960938 29.915928 \nL 125.0125 29.810822 \nL 128.064063 29.709404 \nL 131.115625 29.611674 \nL 134.167188 29.517632 \nL 137.21875 29.427278 \nL 140.270313 29.340612 \nL 143.321875 29.257634 \nL 146.373438 29.178343 \nL 149.425 29.102741 \nL 152.476563 29.030826 \nL 155.528125 28.9626 \nL 155.876875 28.955224 \nL 158.579688 28.900067 \nL 161.63125 28.841351 \nL 164.682813 28.786194 \nL 167.734375 28.734595 \nL 170.785938 28.686555 \nL 173.8375 28.642074 \nL 176.889063 28.601151 \nL 179.940625 28.563786 \nL 182.992188 28.52998 \nL 186.04375 28.499733 \nL 189.095313 28.473044 \nL 192.146875 28.449914 \nL 195.198438 28.430342 \nL 198.25 28.414328 \nL 201.301563 28.401874 \nL 204.353125 28.392977 \nL 207.404688 28.387639 \nL 210.45625 28.38586 \nL 213.507813 28.387639 \nL 216.559375 28.392977 \nL 219.610938 28.401874 \nL 222.6625 28.414328 \nL 225.714063 28.430342 \nL 228.765625 28.449914 \nL 231.817188 28.473044 \nL 234.86875 28.499733 \nL 237.920313 28.52998 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_5\">\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 73.993118 146.6 \nL 73.135938 146.557026 \nL 70.084375 146.400602 \nL 67.032813 146.24074 \nL 63.98125 146.07744 \nL 60.929688 145.910702 \nL 57.878125 145.740526 \nL 54.826563 145.566912 \nL 51.775 145.389861 \nL 48.723438 145.209371 \nL 45.671875 145.025444 \nL 42.620313 144.838079 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 42.620313 26.660429 \nL 45.671875 26.473063 \nL 48.723438 26.289136 \nL 51.775 26.108647 \nL 54.826563 25.931595 \nL 57.878125 25.757981 \nL 60.929688 25.587805 \nL 63.98125 25.421068 \nL 67.032813 25.257768 \nL 70.084375 25.097905 \nL 73.135938 24.941481 \nL 73.993118 24.898507 \nL 76.1875 24.792102 \nL 79.239063 24.647457 \nL 82.290625 24.506137 \nL 85.342188 24.368142 \nL 88.39375 24.233472 \nL 91.445313 24.102127 \nL 94.496875 23.974108 \nL 97.548438 23.849414 \nL 100.6 23.728045 \nL 103.651563 23.610001 \nL 106.703125 23.495283 \nL 109.754688 23.383889 \nL 112.80625 23.275821 \nL 115.857813 23.171078 \nL 118.909375 23.06966 \nL 121.960938 22.971567 \nL 125.0125 22.8768 \nL 125.234432 22.870149 \nL 128.064063 22.788049 \nL 131.115625 22.702729 \nL 134.167188 22.620629 \nL 137.21875 22.541748 \nL 140.270313 22.466087 \nL 143.321875 22.393646 \nL 146.373438 22.324424 \nL 149.425 22.258422 \nL 152.476563 22.19564 \nL 155.528125 22.136077 \nL 158.579688 22.079733 \nL 161.63125 22.02661 \nL 164.682813 21.976706 \nL 167.734375 21.930021 \nL 170.785938 21.886557 \nL 173.8375 21.846311 \nL 176.889063 21.809286 \nL 179.940625 21.77548 \nL 182.992188 21.744893 \nL 186.04375 21.717527 \nL 189.095313 21.69338 \nL 192.146875 21.672452 \nL 195.198438 21.654744 \nL 198.25 21.640256 \nL 201.301563 21.628987 \nL 204.353125 21.620938 \nL 207.404688 21.616109 \nL 210.45625 21.614499 \nL 213.507813 21.616109 \nL 216.559375 21.620938 \nL 219.610938 21.628987 \nL 222.6625 21.640256 \nL 225.714063 21.654744 \nL 228.765625 21.672452 \nL 231.817188 21.69338 \nL 234.86875 21.717527 \nL 237.920313 21.744893 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_6\">\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 42.620313 20.069455 \nL 45.671875 19.899385 \nL 48.723438 19.732435 \nL 51.775 19.568606 \nL 54.826563 19.407898 \nL 57.878125 19.25031 \nL 60.929688 19.095843 \nL 63.98125 18.944496 \nL 66.679474 18.813433 \nL 67.032813 18.796782 \nL 70.084375 18.656008 \nL 73.135938 18.518261 \nL 76.1875 18.383542 \nL 79.239063 18.25185 \nL 82.290625 18.123186 \nL 85.342188 17.997548 \nL 88.39375 17.874939 \nL 91.445313 17.755356 \nL 94.496875 17.638802 \nL 97.548438 17.525274 \nL 100.6 17.414774 \nL 103.651563 17.307301 \nL 106.703125 17.202856 \nL 109.754688 17.101438 \nL 112.80625 17.003047 \nL 115.857813 16.907684 \nL 118.909375 16.815349 \nL 119.943803 16.785075 \nL 121.960938 16.727751 \nL 125.0125 16.643971 \nL 128.064063 16.563131 \nL 131.115625 16.48523 \nL 134.167188 16.410269 \nL 137.21875 16.338248 \nL 140.270313 16.269166 \nL 143.321875 16.203024 \nL 146.373438 16.139822 \nL 149.425 16.079559 \nL 152.476563 16.022236 \nL 155.528125 15.967852 \nL 158.579688 15.916408 \nL 161.63125 15.867904 \nL 164.682813 15.822339 \nL 167.734375 15.779714 \nL 170.785938 15.740029 \nL 173.8375 15.703284 \nL 176.889063 15.669478 \nL 179.940625 15.638611 \nL 182.992188 15.610685 \nL 186.04375 15.585698 \nL 189.095313 15.56365 \nL 192.146875 15.544543 \nL 195.198438 15.528374 \nL 198.25 15.515146 \nL 201.301563 15.504857 \nL 204.353125 15.497508 \nL 207.404688 15.493099 \nL 210.45625 15.491629 \nL 213.507813 15.493099 \nL 216.559375 15.497508 \nL 219.610938 15.504857 \nL 222.6625 15.515146 \nL 225.714063 15.528374 \nL 228.765625 15.544543 \nL 231.817188 15.56365 \nL 234.86875 15.585698 \nL 237.920313 15.610685 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"LineCollection_7\">\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 42.620313 14.078216 \nL 45.671875 13.922518 \nL 48.723438 13.769677 \nL 51.775 13.619693 \nL 54.826563 13.472566 \nL 57.878125 13.328295 \nL 60.929688 13.186881 \nL 63.98125 13.048325 \nL 67.032813 12.912625 \nL 70.084375 12.779781 \nL 71.291587 12.728358 \nL 73.135938 12.651947 \nL 76.1875 12.528301 \nL 79.239063 12.407433 \nL 82.290625 12.289344 \nL 85.342188 12.174033 \nL 88.39375 12.061501 \nL 91.445313 11.951747 \nL 94.496875 11.844772 \nL 97.548438 11.740576 \nL 100.6 11.639158 \nL 103.651563 11.540518 \nL 106.703125 11.444658 \nL 109.754688 11.351575 \nL 112.80625 11.261272 \nL 115.857813 11.173747 \nL 118.909375 11.089 \nL 121.960938 11.007032 \nL 125.0125 10.927843 \nL 128.064063 10.851432 \nL 131.115625 10.7778 \nL 134.167188 10.706946 \nL 134.478571 10.7 \n\" style=\"fill:none;stroke:#1f77b4;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"line2d_7\">\n    <path clip-path=\"url(#p76bf60bd6e)\" d=\"M 57.878125 126.316418 \nL 76.1875 28.955224 \nL 101.454438 116.580299 \nL 127.168124 86.398328 \nL 150.019542 69.749564 \nL 168.697656 99.824437 \nL 183.047744 81.081434 \nL 193.511809 82.9127 \nL 200.777175 90.636062 \nL 205.571346 82.769403 \nL 208.554621 85.987715 \nL 210.274453 87.024564 \nL 211.156185 84.482244 \nL 211.513059 86.251907 \nL 211.564679 85.93037 \nL 211.457477 85.334922 \nL 211.283729 86.031594 \nL 211.097558 85.702313 \nL 210.927515 85.65033 \nL 210.785942 85.861755 \nL 210.675592 85.697464 \n\" style=\"fill:none;stroke:#ff7f0e;stroke-linecap:square;stroke-width:1.5;\"/>\n    <defs>\n     <path d=\"M 0 3 \nC 0.795609 3 1.55874 2.683901 2.12132 2.12132 \nC 2.683901 1.55874 3 0.795609 3 0 \nC 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 \nC 1.55874 -2.683901 0.795609 -3 0 -3 \nC -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 \nC -2.683901 -1.55874 -3 -0.795609 -3 0 \nC -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 \nC -1.55874 2.683901 -0.795609 3 0 3 \nz\n\" id=\"mda0b3f4095\" style=\"stroke:#ff7f0e;\"/>\n    </defs>\n    <g clip-path=\"url(#p76bf60bd6e)\">\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"57.878125\" xlink:href=\"#mda0b3f4095\" y=\"126.316418\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"76.1875\" xlink:href=\"#mda0b3f4095\" y=\"28.955224\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"101.454438\" xlink:href=\"#mda0b3f4095\" y=\"116.580299\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"127.168124\" xlink:href=\"#mda0b3f4095\" y=\"86.398328\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"150.019542\" xlink:href=\"#mda0b3f4095\" y=\"69.749564\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"168.697656\" xlink:href=\"#mda0b3f4095\" y=\"99.824437\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"183.047744\" xlink:href=\"#mda0b3f4095\" y=\"81.081434\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"193.511809\" xlink:href=\"#mda0b3f4095\" y=\"82.9127\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"200.777175\" xlink:href=\"#mda0b3f4095\" y=\"90.636062\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"205.571346\" xlink:href=\"#mda0b3f4095\" y=\"82.769403\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"208.554621\" xlink:href=\"#mda0b3f4095\" y=\"85.987715\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"210.274453\" xlink:href=\"#mda0b3f4095\" y=\"87.024564\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"211.156185\" xlink:href=\"#mda0b3f4095\" y=\"84.482244\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"211.513059\" xlink:href=\"#mda0b3f4095\" y=\"86.251907\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"211.564679\" xlink:href=\"#mda0b3f4095\" y=\"85.93037\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"211.457477\" xlink:href=\"#mda0b3f4095\" y=\"85.334922\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"211.283729\" xlink:href=\"#mda0b3f4095\" y=\"86.031594\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"211.097558\" xlink:href=\"#mda0b3f4095\" y=\"85.702313\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"210.927515\" xlink:href=\"#mda0b3f4095\" y=\"85.65033\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"210.785942\" xlink:href=\"#mda0b3f4095\" y=\"85.861755\"/>\n     <use style=\"fill:#ff7f0e;stroke:#ff7f0e;\" x=\"210.675592\" xlink:href=\"#mda0b3f4095\" y=\"85.697464\"/>\n    </g>\n   </g>\n   <g id=\"patch_3\">\n    <path d=\"M 42.620312 146.6 \nL 42.620312 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_4\">\n    <path d=\"M 237.920313 146.6 \nL 237.920313 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_5\">\n    <path d=\"M 42.620313 146.6 \nL 237.920313 146.6 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_6\">\n    <path d=\"M 42.620313 10.7 \nL 237.920313 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n  </g>\n </g>\n <defs>\n  <clipPath id=\"p76bf60bd6e\">\n   <rect height=\"135.9\" width=\"195.3\" x=\"42.620312\" y=\"10.7\"/>\n  </clipPath>\n </defs>\n</svg>\n",
   "text/plain": "<Figure size 252x180 with 1 Axes>"
  },
  "metadata": {},
  "output_type": "display_data"
 }
]
```

### 指数加权移动平均

为了从数学上理解动量法，让我们先解释指数加权移动平均（exponentially weighted moving average）。给定超参数$\gamma$且$0 \leq \gamma < 1$，当前时刻$t$的变量$y_t$是上一时刻$t-1$的变量$y_{t-1}$和当前时刻另一变量$x_t$的线性组合：

$$y_t = \gamma y_{t-1} + (1-\gamma) x_t.$$

我们可以对$y_t$展开：

$$
\begin{aligned}
y_t  &= (1-\gamma) x_t + \gamma y_{t-1}\\
         &= (1-\gamma)x_t + (1-\gamma) \cdot \gamma x_{t-1} + \gamma^2y_{t-2}\\
         &= (1-\gamma)x_t + (1-\gamma) \cdot \gamma x_{t-1} + (1-\gamma) \cdot \gamma^2x_{t-2} + \gamma^3y_{t-3}\\
         &\ldots
\end{aligned}
$$

由于

$$ \lim_{n \rightarrow \infty}  \left(1-\frac{1}{n}\right)^n = \exp(-1) \approx 0.3679,$$

令$n = 1/(1-\gamma)$，那么有 $\left(1-\frac{1}{n}\right)^n = \gamma^{\frac{1}{1-\gamma}}$。所以当$\gamma \rightarrow 1$时，$\gamma^{1/(1-\gamma)}=\exp(-1)$。例如$0.95^{20} = 0.358 \approx \exp(-1)$。如果把$\exp(-1)$当做一个比较小的数，我们可以在近似中忽略所有含$\gamma^{1/(1-\gamma)}$和比$\gamma^{1/(1-\gamma)}$更高阶的系数的项。例如，当$\gamma=0.95$时，

$$y_t \approx 0.05 \sum_{i=0}^{19} 0.95^i x_{t-i}.$$

因此，在实际中，我们常常将$y$看作是对最近$1/(1-\gamma)$个时刻的$x$值的加权平均。例如，当$\gamma = 0.95$时，$y$可以被看作是对最近20个时刻的$x$值的加权平均；当$\gamma = 0.9$时，$y$可以看作是对最近10个时刻的$x$值的加权平均。且离当前时刻越近的$x$值获得的权重越大（越接近1）。


### 由指数加权移动平均理解动量法

现在，我们对动量法的速度变量做变形：

$$\boldsymbol{v}_t \leftarrow \gamma \boldsymbol{v}_{t-1} + (1 - \gamma) \left(\frac{\eta_t}{1 - \gamma} \boldsymbol{g}_t\right). $$

由指数加权移动平均的形式可得，速度变量$\boldsymbol{v}_t$实际上对序列$\{\eta_{t-i}\boldsymbol{g}_{t-i} /(1-\gamma):i=0,\ldots,1/(1-\gamma)-1\}$做了指数加权移动平均。换句话说，相比于小批量随机梯度下降，动量法在每个时间步的自变量更新量近似于将前者对应的最近$1/(1-\gamma)$个时间步的更新量做了指数加权移动平均后再除以$1-\gamma$。所以动量法中，自变量在各个方向上的移动幅度不仅取决当前梯度，还取决过去各个梯度在各个方向上是否一致。在本节之前示例的优化问题中，由于所有梯度在水平方向上为正（向右）、而在竖直方向上时正（向上）时负（向下），自变量在水平方向的移动幅度逐渐增大，而在竖直方向的移动幅度逐渐减小。这样，我们就可以使用较大的学习率，从而使自变量向最优解更快移动。


## 从零开始实现

相对于随机梯度下降，动量法需要对每个自变量维护同它一样形状的状态变量$\boldsymbol{v}$，且超参数里多了动量超参数。

```{.python .input  n=6}
features, labels = gb.get_data_ch7()

def init_momentum_states():
    v_w = nd.zeros((features.shape[1], 1))
    v_b = nd.zeros(1)
    return (v_w, v_b)

def sgd_momentum(params, states, hyperparams):
    hp = hyperparams 
    for p, v in zip(params, states):
        v[:] = hp['mom'] * v + hp['lr'] * p.grad
        p[:] -= v
```

我们先将动量超参数`mom`设0.5，这时可以看成是使用最近2个时刻的$2\nabla f_\mathcal{B}(\boldsymbol{x})$的加权平均作为梯度的随机梯度下降，因此我们需要对应调下学习率（从上节的0.5减小到了0.02）。

```{.python .input  n=7}
gb.train_ch7(sgd_momentum, init_momentum_states(), 
             {'lr': 0.02, 'mom': 0.5}, features, labels)
```

```{.json .output n=7}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "loss: 0.260068, 0.323728 sec per epoch\n"
 },
 {
  "data": {
   "image/svg+xml": "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n  \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Created with matplotlib (http://matplotlib.org/) -->\n<svg height=\"184.15625pt\" version=\"1.1\" viewBox=\"0 0 256.14375 184.15625\" width=\"256.14375pt\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n <defs>\n  <style type=\"text/css\">\n*{stroke-linecap:butt;stroke-linejoin:round;}\n  </style>\n </defs>\n <g id=\"figure_1\">\n  <g id=\"patch_1\">\n   <path d=\"M 0 184.15625 \nL 256.14375 184.15625 \nL 256.14375 -0 \nL 0 -0 \nz\n\" style=\"fill:none;\"/>\n  </g>\n  <g id=\"axes_1\">\n   <g id=\"patch_2\">\n    <path d=\"M 50.14375 146.6 \nL 245.44375 146.6 \nL 245.44375 10.7 \nL 50.14375 10.7 \nz\n\" style=\"fill:#ffffff;\"/>\n   </g>\n   <g id=\"matplotlib.axis_1\">\n    <g id=\"xtick_1\">\n     <g id=\"line2d_1\">\n      <defs>\n       <path d=\"M 0 0 \nL 0 3.5 \n\" id=\"mca95267524\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"59.021023\" xlink:href=\"#mca95267524\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_1\">\n      <!-- 0.0 -->\n      <defs>\n       <path d=\"M 31.78125 66.40625 \nQ 24.171875 66.40625 20.328125 58.90625 \nQ 16.5 51.421875 16.5 36.375 \nQ 16.5 21.390625 20.328125 13.890625 \nQ 24.171875 6.390625 31.78125 6.390625 \nQ 39.453125 6.390625 43.28125 13.890625 \nQ 47.125 21.390625 47.125 36.375 \nQ 47.125 51.421875 43.28125 58.90625 \nQ 39.453125 66.40625 31.78125 66.40625 \nz\nM 31.78125 74.21875 \nQ 44.046875 74.21875 50.515625 64.515625 \nQ 56.984375 54.828125 56.984375 36.375 \nQ 56.984375 17.96875 50.515625 8.265625 \nQ 44.046875 -1.421875 31.78125 -1.421875 \nQ 19.53125 -1.421875 13.0625 8.265625 \nQ 6.59375 17.96875 6.59375 36.375 \nQ 6.59375 54.828125 13.0625 64.515625 \nQ 19.53125 74.21875 31.78125 74.21875 \nz\n\" id=\"DejaVuSans-30\"/>\n       <path d=\"M 10.6875 12.40625 \nL 21 12.40625 \nL 21 0 \nL 10.6875 0 \nz\n\" id=\"DejaVuSans-2e\"/>\n      </defs>\n      <g transform=\"translate(51.06946 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_2\">\n     <g id=\"line2d_2\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"103.407386\" xlink:href=\"#mca95267524\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_2\">\n      <!-- 0.5 -->\n      <defs>\n       <path d=\"M 10.796875 72.90625 \nL 49.515625 72.90625 \nL 49.515625 64.59375 \nL 19.828125 64.59375 \nL 19.828125 46.734375 \nQ 21.96875 47.46875 24.109375 47.828125 \nQ 26.265625 48.1875 28.421875 48.1875 \nQ 40.625 48.1875 47.75 41.5 \nQ 54.890625 34.8125 54.890625 23.390625 \nQ 54.890625 11.625 47.5625 5.09375 \nQ 40.234375 -1.421875 26.90625 -1.421875 \nQ 22.3125 -1.421875 17.546875 -0.640625 \nQ 12.796875 0.140625 7.71875 1.703125 \nL 7.71875 11.625 \nQ 12.109375 9.234375 16.796875 8.0625 \nQ 21.484375 6.890625 26.703125 6.890625 \nQ 35.15625 6.890625 40.078125 11.328125 \nQ 45.015625 15.765625 45.015625 23.390625 \nQ 45.015625 31 40.078125 35.4375 \nQ 35.15625 39.890625 26.703125 39.890625 \nQ 22.75 39.890625 18.8125 39.015625 \nQ 14.890625 38.140625 10.796875 36.28125 \nz\n\" id=\"DejaVuSans-35\"/>\n      </defs>\n      <g transform=\"translate(95.455824 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-35\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_3\">\n     <g id=\"line2d_3\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"147.79375\" xlink:href=\"#mca95267524\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_3\">\n      <!-- 1.0 -->\n      <defs>\n       <path d=\"M 12.40625 8.296875 \nL 28.515625 8.296875 \nL 28.515625 63.921875 \nL 10.984375 60.40625 \nL 10.984375 69.390625 \nL 28.421875 72.90625 \nL 38.28125 72.90625 \nL 38.28125 8.296875 \nL 54.390625 8.296875 \nL 54.390625 0 \nL 12.40625 0 \nz\n\" id=\"DejaVuSans-31\"/>\n      </defs>\n      <g transform=\"translate(139.842187 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-31\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_4\">\n     <g id=\"line2d_4\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"192.180114\" xlink:href=\"#mca95267524\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_4\">\n      <!-- 1.5 -->\n      <g transform=\"translate(184.228551 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-31\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-35\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_5\">\n     <g id=\"line2d_5\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"236.566477\" xlink:href=\"#mca95267524\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_5\">\n      <!-- 2.0 -->\n      <defs>\n       <path d=\"M 19.1875 8.296875 \nL 53.609375 8.296875 \nL 53.609375 0 \nL 7.328125 0 \nL 7.328125 8.296875 \nQ 12.9375 14.109375 22.625 23.890625 \nQ 32.328125 33.6875 34.8125 36.53125 \nQ 39.546875 41.84375 41.421875 45.53125 \nQ 43.3125 49.21875 43.3125 52.78125 \nQ 43.3125 58.59375 39.234375 62.25 \nQ 35.15625 65.921875 28.609375 65.921875 \nQ 23.96875 65.921875 18.8125 64.3125 \nQ 13.671875 62.703125 7.8125 59.421875 \nL 7.8125 69.390625 \nQ 13.765625 71.78125 18.9375 73 \nQ 24.125 74.21875 28.421875 74.21875 \nQ 39.75 74.21875 46.484375 68.546875 \nQ 53.21875 62.890625 53.21875 53.421875 \nQ 53.21875 48.921875 51.53125 44.890625 \nQ 49.859375 40.875 45.40625 35.40625 \nQ 44.1875 33.984375 37.640625 27.21875 \nQ 31.109375 20.453125 19.1875 8.296875 \nz\n\" id=\"DejaVuSans-32\"/>\n      </defs>\n      <g transform=\"translate(228.614915 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-32\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_6\">\n     <!-- epoch -->\n     <defs>\n      <path d=\"M 56.203125 29.59375 \nL 56.203125 25.203125 \nL 14.890625 25.203125 \nQ 15.484375 15.921875 20.484375 11.0625 \nQ 25.484375 6.203125 34.421875 6.203125 \nQ 39.59375 6.203125 44.453125 7.46875 \nQ 49.3125 8.734375 54.109375 11.28125 \nL 54.109375 2.78125 \nQ 49.265625 0.734375 44.1875 -0.34375 \nQ 39.109375 -1.421875 33.890625 -1.421875 \nQ 20.796875 -1.421875 13.15625 6.1875 \nQ 5.515625 13.8125 5.515625 26.8125 \nQ 5.515625 40.234375 12.765625 48.109375 \nQ 20.015625 56 32.328125 56 \nQ 43.359375 56 49.78125 48.890625 \nQ 56.203125 41.796875 56.203125 29.59375 \nz\nM 47.21875 32.234375 \nQ 47.125 39.59375 43.09375 43.984375 \nQ 39.0625 48.390625 32.421875 48.390625 \nQ 24.90625 48.390625 20.390625 44.140625 \nQ 15.875 39.890625 15.1875 32.171875 \nz\n\" id=\"DejaVuSans-65\"/>\n      <path d=\"M 18.109375 8.203125 \nL 18.109375 -20.796875 \nL 9.078125 -20.796875 \nL 9.078125 54.6875 \nL 18.109375 54.6875 \nL 18.109375 46.390625 \nQ 20.953125 51.265625 25.265625 53.625 \nQ 29.59375 56 35.59375 56 \nQ 45.5625 56 51.78125 48.09375 \nQ 58.015625 40.1875 58.015625 27.296875 \nQ 58.015625 14.40625 51.78125 6.484375 \nQ 45.5625 -1.421875 35.59375 -1.421875 \nQ 29.59375 -1.421875 25.265625 0.953125 \nQ 20.953125 3.328125 18.109375 8.203125 \nz\nM 48.6875 27.296875 \nQ 48.6875 37.203125 44.609375 42.84375 \nQ 40.53125 48.484375 33.40625 48.484375 \nQ 26.265625 48.484375 22.1875 42.84375 \nQ 18.109375 37.203125 18.109375 27.296875 \nQ 18.109375 17.390625 22.1875 11.75 \nQ 26.265625 6.109375 33.40625 6.109375 \nQ 40.53125 6.109375 44.609375 11.75 \nQ 48.6875 17.390625 48.6875 27.296875 \nz\n\" id=\"DejaVuSans-70\"/>\n      <path d=\"M 30.609375 48.390625 \nQ 23.390625 48.390625 19.1875 42.75 \nQ 14.984375 37.109375 14.984375 27.296875 \nQ 14.984375 17.484375 19.15625 11.84375 \nQ 23.34375 6.203125 30.609375 6.203125 \nQ 37.796875 6.203125 41.984375 11.859375 \nQ 46.1875 17.53125 46.1875 27.296875 \nQ 46.1875 37.015625 41.984375 42.703125 \nQ 37.796875 48.390625 30.609375 48.390625 \nz\nM 30.609375 56 \nQ 42.328125 56 49.015625 48.375 \nQ 55.71875 40.765625 55.71875 27.296875 \nQ 55.71875 13.875 49.015625 6.21875 \nQ 42.328125 -1.421875 30.609375 -1.421875 \nQ 18.84375 -1.421875 12.171875 6.21875 \nQ 5.515625 13.875 5.515625 27.296875 \nQ 5.515625 40.765625 12.171875 48.375 \nQ 18.84375 56 30.609375 56 \nz\n\" id=\"DejaVuSans-6f\"/>\n      <path d=\"M 48.78125 52.59375 \nL 48.78125 44.1875 \nQ 44.96875 46.296875 41.140625 47.34375 \nQ 37.3125 48.390625 33.40625 48.390625 \nQ 24.65625 48.390625 19.8125 42.84375 \nQ 14.984375 37.3125 14.984375 27.296875 \nQ 14.984375 17.28125 19.8125 11.734375 \nQ 24.65625 6.203125 33.40625 6.203125 \nQ 37.3125 6.203125 41.140625 7.25 \nQ 44.96875 8.296875 48.78125 10.40625 \nL 48.78125 2.09375 \nQ 45.015625 0.34375 40.984375 -0.53125 \nQ 36.96875 -1.421875 32.421875 -1.421875 \nQ 20.0625 -1.421875 12.78125 6.34375 \nQ 5.515625 14.109375 5.515625 27.296875 \nQ 5.515625 40.671875 12.859375 48.328125 \nQ 20.21875 56 33.015625 56 \nQ 37.15625 56 41.109375 55.140625 \nQ 45.0625 54.296875 48.78125 52.59375 \nz\n\" id=\"DejaVuSans-63\"/>\n      <path d=\"M 54.890625 33.015625 \nL 54.890625 0 \nL 45.90625 0 \nL 45.90625 32.71875 \nQ 45.90625 40.484375 42.875 44.328125 \nQ 39.84375 48.1875 33.796875 48.1875 \nQ 26.515625 48.1875 22.3125 43.546875 \nQ 18.109375 38.921875 18.109375 30.90625 \nL 18.109375 0 \nL 9.078125 0 \nL 9.078125 75.984375 \nL 18.109375 75.984375 \nL 18.109375 46.1875 \nQ 21.34375 51.125 25.703125 53.5625 \nQ 30.078125 56 35.796875 56 \nQ 45.21875 56 50.046875 50.171875 \nQ 54.890625 44.34375 54.890625 33.015625 \nz\n\" id=\"DejaVuSans-68\"/>\n     </defs>\n     <g transform=\"translate(132.565625 174.876562)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-65\"/>\n      <use x=\"61.523438\" xlink:href=\"#DejaVuSans-70\"/>\n      <use x=\"125\" xlink:href=\"#DejaVuSans-6f\"/>\n      <use x=\"186.181641\" xlink:href=\"#DejaVuSans-63\"/>\n      <use x=\"241.162109\" xlink:href=\"#DejaVuSans-68\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"matplotlib.axis_2\">\n    <g id=\"ytick_1\">\n     <g id=\"line2d_6\">\n      <defs>\n       <path d=\"M 0 0 \nL -3.5 0 \n\" id=\"m551aa0e7a2\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#m551aa0e7a2\" y=\"144.618349\"/>\n      </g>\n     </g>\n     <g id=\"text_7\">\n      <!-- 0.25 -->\n      <g transform=\"translate(20.878125 148.417568)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-32\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-35\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_2\">\n     <g id=\"line2d_7\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#m551aa0e7a2\" y=\"120.164345\"/>\n      </g>\n     </g>\n     <g id=\"text_8\">\n      <!-- 0.30 -->\n      <defs>\n       <path d=\"M 40.578125 39.3125 \nQ 47.65625 37.796875 51.625 33 \nQ 55.609375 28.21875 55.609375 21.1875 \nQ 55.609375 10.40625 48.1875 4.484375 \nQ 40.765625 -1.421875 27.09375 -1.421875 \nQ 22.515625 -1.421875 17.65625 -0.515625 \nQ 12.796875 0.390625 7.625 2.203125 \nL 7.625 11.71875 \nQ 11.71875 9.328125 16.59375 8.109375 \nQ 21.484375 6.890625 26.8125 6.890625 \nQ 36.078125 6.890625 40.9375 10.546875 \nQ 45.796875 14.203125 45.796875 21.1875 \nQ 45.796875 27.640625 41.28125 31.265625 \nQ 36.765625 34.90625 28.71875 34.90625 \nL 20.21875 34.90625 \nL 20.21875 43.015625 \nL 29.109375 43.015625 \nQ 36.375 43.015625 40.234375 45.921875 \nQ 44.09375 48.828125 44.09375 54.296875 \nQ 44.09375 59.90625 40.109375 62.90625 \nQ 36.140625 65.921875 28.71875 65.921875 \nQ 24.65625 65.921875 20.015625 65.03125 \nQ 15.375 64.15625 9.8125 62.3125 \nL 9.8125 71.09375 \nQ 15.4375 72.65625 20.34375 73.4375 \nQ 25.25 74.21875 29.59375 74.21875 \nQ 40.828125 74.21875 47.359375 69.109375 \nQ 53.90625 64.015625 53.90625 55.328125 \nQ 53.90625 49.265625 50.4375 45.09375 \nQ 46.96875 40.921875 40.578125 39.3125 \nz\n\" id=\"DejaVuSans-33\"/>\n      </defs>\n      <g transform=\"translate(20.878125 123.963564)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-33\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_3\">\n     <g id=\"line2d_8\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#m551aa0e7a2\" y=\"95.710341\"/>\n      </g>\n     </g>\n     <g id=\"text_9\">\n      <!-- 0.35 -->\n      <g transform=\"translate(20.878125 99.509559)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-33\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-35\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_4\">\n     <g id=\"line2d_9\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#m551aa0e7a2\" y=\"71.256337\"/>\n      </g>\n     </g>\n     <g id=\"text_10\">\n      <!-- 0.40 -->\n      <defs>\n       <path d=\"M 37.796875 64.3125 \nL 12.890625 25.390625 \nL 37.796875 25.390625 \nz\nM 35.203125 72.90625 \nL 47.609375 72.90625 \nL 47.609375 25.390625 \nL 58.015625 25.390625 \nL 58.015625 17.1875 \nL 47.609375 17.1875 \nL 47.609375 0 \nL 37.796875 0 \nL 37.796875 17.1875 \nL 4.890625 17.1875 \nL 4.890625 26.703125 \nz\n\" id=\"DejaVuSans-34\"/>\n      </defs>\n      <g transform=\"translate(20.878125 75.055555)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-34\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_5\">\n     <g id=\"line2d_10\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#m551aa0e7a2\" y=\"46.802332\"/>\n      </g>\n     </g>\n     <g id=\"text_11\">\n      <!-- 0.45 -->\n      <g transform=\"translate(20.878125 50.601551)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-34\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-35\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_6\">\n     <g id=\"line2d_11\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#m551aa0e7a2\" y=\"22.348328\"/>\n      </g>\n     </g>\n     <g id=\"text_12\">\n      <!-- 0.50 -->\n      <g transform=\"translate(20.878125 26.147547)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-35\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_13\">\n     <!-- loss -->\n     <defs>\n      <path d=\"M 9.421875 75.984375 \nL 18.40625 75.984375 \nL 18.40625 0 \nL 9.421875 0 \nz\n\" id=\"DejaVuSans-6c\"/>\n      <path d=\"M 44.28125 53.078125 \nL 44.28125 44.578125 \nQ 40.484375 46.53125 36.375 47.5 \nQ 32.28125 48.484375 27.875 48.484375 \nQ 21.1875 48.484375 17.84375 46.4375 \nQ 14.5 44.390625 14.5 40.28125 \nQ 14.5 37.15625 16.890625 35.375 \nQ 19.28125 33.59375 26.515625 31.984375 \nL 29.59375 31.296875 \nQ 39.15625 29.25 43.1875 25.515625 \nQ 47.21875 21.78125 47.21875 15.09375 \nQ 47.21875 7.46875 41.1875 3.015625 \nQ 35.15625 -1.421875 24.609375 -1.421875 \nQ 20.21875 -1.421875 15.453125 -0.5625 \nQ 10.6875 0.296875 5.421875 2 \nL 5.421875 11.28125 \nQ 10.40625 8.6875 15.234375 7.390625 \nQ 20.0625 6.109375 24.8125 6.109375 \nQ 31.15625 6.109375 34.5625 8.28125 \nQ 37.984375 10.453125 37.984375 14.40625 \nQ 37.984375 18.0625 35.515625 20.015625 \nQ 33.0625 21.96875 24.703125 23.78125 \nL 21.578125 24.515625 \nQ 13.234375 26.265625 9.515625 29.90625 \nQ 5.8125 33.546875 5.8125 39.890625 \nQ 5.8125 47.609375 11.28125 51.796875 \nQ 16.75 56 26.8125 56 \nQ 31.78125 56 36.171875 55.265625 \nQ 40.578125 54.546875 44.28125 53.078125 \nz\n\" id=\"DejaVuSans-73\"/>\n     </defs>\n     <g transform=\"translate(14.798437 88.307812)rotate(-90)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-6c\"/>\n      <use x=\"27.783203\" xlink:href=\"#DejaVuSans-6f\"/>\n      <use x=\"88.964844\" xlink:href=\"#DejaVuSans-73\"/>\n      <use x=\"141.064453\" xlink:href=\"#DejaVuSans-73\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"line2d_12\">\n    <path clip-path=\"url(#pe3186bfff7)\" d=\"M 59.021023 16.877273 \nL 64.939205 53.086282 \nL 70.857386 83.474695 \nL 76.775568 100.89264 \nL 82.69375 113.968753 \nL 88.611932 121.427719 \nL 94.530114 126.967718 \nL 100.448295 129.634769 \nL 106.366477 131.861706 \nL 112.284659 134.328268 \nL 118.202841 135.141083 \nL 124.121023 134.432484 \nL 130.039205 136.653052 \nL 135.957386 138.054318 \nL 141.875568 138.235961 \nL 147.79375 139.510695 \nL 153.711932 138.990429 \nL 159.630114 139.590031 \nL 165.548295 139.687761 \nL 171.466477 139.986651 \nL 177.384659 139.183499 \nL 183.302841 140.054545 \nL 189.221023 139.033617 \nL 195.139205 139.413023 \nL 201.057386 139.797137 \nL 206.975568 138.898034 \nL 212.89375 140.284389 \nL 218.811932 139.68091 \nL 224.730114 140.422727 \nL 230.648295 140.34122 \nL 236.566477 139.694524 \n\" style=\"fill:none;stroke:#1f77b4;stroke-linecap:square;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"patch_3\">\n    <path d=\"M 50.14375 146.6 \nL 50.14375 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_4\">\n    <path d=\"M 245.44375 146.6 \nL 245.44375 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_5\">\n    <path d=\"M 50.14375 146.6 \nL 245.44375 146.6 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_6\">\n    <path d=\"M 50.14375 10.7 \nL 245.44375 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n  </g>\n </g>\n <defs>\n  <clipPath id=\"pe3186bfff7\">\n   <rect height=\"135.9\" width=\"195.3\" x=\"50.14375\" y=\"10.7\"/>\n  </clipPath>\n </defs>\n</svg>\n",
   "text/plain": "<Figure size 252x180 with 1 Axes>"
  },
  "metadata": {},
  "output_type": "display_data"
 }
]
```

将动量超参数`mom`增大到了0.9时，这个特殊梯度是最近10个时刻的$10\nabla f_\mathcal{B}(\boldsymbol{x})$的加权平均。因此我们需要进一步调低学习率。

```{.python .input  n=8}
gb.train_ch7(sgd_momentum, init_momentum_states(), 
             {'lr': 0.004, 'mom': 0.9}, features, labels)
```

```{.json .output n=8}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "loss: 0.260045, 0.311964 sec per epoch\n"
 },
 {
  "data": {
   "image/svg+xml": "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n  \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Created with matplotlib (http://matplotlib.org/) -->\n<svg height=\"184.15625pt\" version=\"1.1\" viewBox=\"0 0 256.14375 184.15625\" width=\"256.14375pt\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n <defs>\n  <style type=\"text/css\">\n*{stroke-linecap:butt;stroke-linejoin:round;}\n  </style>\n </defs>\n <g id=\"figure_1\">\n  <g id=\"patch_1\">\n   <path d=\"M 0 184.15625 \nL 256.14375 184.15625 \nL 256.14375 -0 \nL 0 -0 \nz\n\" style=\"fill:none;\"/>\n  </g>\n  <g id=\"axes_1\">\n   <g id=\"patch_2\">\n    <path d=\"M 50.14375 146.6 \nL 245.44375 146.6 \nL 245.44375 10.7 \nL 50.14375 10.7 \nz\n\" style=\"fill:#ffffff;\"/>\n   </g>\n   <g id=\"matplotlib.axis_1\">\n    <g id=\"xtick_1\">\n     <g id=\"line2d_1\">\n      <defs>\n       <path d=\"M 0 0 \nL 0 3.5 \n\" id=\"m9045b1f341\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"59.021023\" xlink:href=\"#m9045b1f341\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_1\">\n      <!-- 0.0 -->\n      <defs>\n       <path d=\"M 31.78125 66.40625 \nQ 24.171875 66.40625 20.328125 58.90625 \nQ 16.5 51.421875 16.5 36.375 \nQ 16.5 21.390625 20.328125 13.890625 \nQ 24.171875 6.390625 31.78125 6.390625 \nQ 39.453125 6.390625 43.28125 13.890625 \nQ 47.125 21.390625 47.125 36.375 \nQ 47.125 51.421875 43.28125 58.90625 \nQ 39.453125 66.40625 31.78125 66.40625 \nz\nM 31.78125 74.21875 \nQ 44.046875 74.21875 50.515625 64.515625 \nQ 56.984375 54.828125 56.984375 36.375 \nQ 56.984375 17.96875 50.515625 8.265625 \nQ 44.046875 -1.421875 31.78125 -1.421875 \nQ 19.53125 -1.421875 13.0625 8.265625 \nQ 6.59375 17.96875 6.59375 36.375 \nQ 6.59375 54.828125 13.0625 64.515625 \nQ 19.53125 74.21875 31.78125 74.21875 \nz\n\" id=\"DejaVuSans-30\"/>\n       <path d=\"M 10.6875 12.40625 \nL 21 12.40625 \nL 21 0 \nL 10.6875 0 \nz\n\" id=\"DejaVuSans-2e\"/>\n      </defs>\n      <g transform=\"translate(51.06946 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_2\">\n     <g id=\"line2d_2\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"103.407386\" xlink:href=\"#m9045b1f341\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_2\">\n      <!-- 0.5 -->\n      <defs>\n       <path d=\"M 10.796875 72.90625 \nL 49.515625 72.90625 \nL 49.515625 64.59375 \nL 19.828125 64.59375 \nL 19.828125 46.734375 \nQ 21.96875 47.46875 24.109375 47.828125 \nQ 26.265625 48.1875 28.421875 48.1875 \nQ 40.625 48.1875 47.75 41.5 \nQ 54.890625 34.8125 54.890625 23.390625 \nQ 54.890625 11.625 47.5625 5.09375 \nQ 40.234375 -1.421875 26.90625 -1.421875 \nQ 22.3125 -1.421875 17.546875 -0.640625 \nQ 12.796875 0.140625 7.71875 1.703125 \nL 7.71875 11.625 \nQ 12.109375 9.234375 16.796875 8.0625 \nQ 21.484375 6.890625 26.703125 6.890625 \nQ 35.15625 6.890625 40.078125 11.328125 \nQ 45.015625 15.765625 45.015625 23.390625 \nQ 45.015625 31 40.078125 35.4375 \nQ 35.15625 39.890625 26.703125 39.890625 \nQ 22.75 39.890625 18.8125 39.015625 \nQ 14.890625 38.140625 10.796875 36.28125 \nz\n\" id=\"DejaVuSans-35\"/>\n      </defs>\n      <g transform=\"translate(95.455824 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-35\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_3\">\n     <g id=\"line2d_3\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"147.79375\" xlink:href=\"#m9045b1f341\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_3\">\n      <!-- 1.0 -->\n      <defs>\n       <path d=\"M 12.40625 8.296875 \nL 28.515625 8.296875 \nL 28.515625 63.921875 \nL 10.984375 60.40625 \nL 10.984375 69.390625 \nL 28.421875 72.90625 \nL 38.28125 72.90625 \nL 38.28125 8.296875 \nL 54.390625 8.296875 \nL 54.390625 0 \nL 12.40625 0 \nz\n\" id=\"DejaVuSans-31\"/>\n      </defs>\n      <g transform=\"translate(139.842187 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-31\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_4\">\n     <g id=\"line2d_4\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"192.180114\" xlink:href=\"#m9045b1f341\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_4\">\n      <!-- 1.5 -->\n      <g transform=\"translate(184.228551 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-31\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-35\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"xtick_5\">\n     <g id=\"line2d_5\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"236.566477\" xlink:href=\"#m9045b1f341\" y=\"146.6\"/>\n      </g>\n     </g>\n     <g id=\"text_5\">\n      <!-- 2.0 -->\n      <defs>\n       <path d=\"M 19.1875 8.296875 \nL 53.609375 8.296875 \nL 53.609375 0 \nL 7.328125 0 \nL 7.328125 8.296875 \nQ 12.9375 14.109375 22.625 23.890625 \nQ 32.328125 33.6875 34.8125 36.53125 \nQ 39.546875 41.84375 41.421875 45.53125 \nQ 43.3125 49.21875 43.3125 52.78125 \nQ 43.3125 58.59375 39.234375 62.25 \nQ 35.15625 65.921875 28.609375 65.921875 \nQ 23.96875 65.921875 18.8125 64.3125 \nQ 13.671875 62.703125 7.8125 59.421875 \nL 7.8125 69.390625 \nQ 13.765625 71.78125 18.9375 73 \nQ 24.125 74.21875 28.421875 74.21875 \nQ 39.75 74.21875 46.484375 68.546875 \nQ 53.21875 62.890625 53.21875 53.421875 \nQ 53.21875 48.921875 51.53125 44.890625 \nQ 49.859375 40.875 45.40625 35.40625 \nQ 44.1875 33.984375 37.640625 27.21875 \nQ 31.109375 20.453125 19.1875 8.296875 \nz\n\" id=\"DejaVuSans-32\"/>\n      </defs>\n      <g transform=\"translate(228.614915 161.198437)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-32\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_6\">\n     <!-- epoch -->\n     <defs>\n      <path d=\"M 56.203125 29.59375 \nL 56.203125 25.203125 \nL 14.890625 25.203125 \nQ 15.484375 15.921875 20.484375 11.0625 \nQ 25.484375 6.203125 34.421875 6.203125 \nQ 39.59375 6.203125 44.453125 7.46875 \nQ 49.3125 8.734375 54.109375 11.28125 \nL 54.109375 2.78125 \nQ 49.265625 0.734375 44.1875 -0.34375 \nQ 39.109375 -1.421875 33.890625 -1.421875 \nQ 20.796875 -1.421875 13.15625 6.1875 \nQ 5.515625 13.8125 5.515625 26.8125 \nQ 5.515625 40.234375 12.765625 48.109375 \nQ 20.015625 56 32.328125 56 \nQ 43.359375 56 49.78125 48.890625 \nQ 56.203125 41.796875 56.203125 29.59375 \nz\nM 47.21875 32.234375 \nQ 47.125 39.59375 43.09375 43.984375 \nQ 39.0625 48.390625 32.421875 48.390625 \nQ 24.90625 48.390625 20.390625 44.140625 \nQ 15.875 39.890625 15.1875 32.171875 \nz\n\" id=\"DejaVuSans-65\"/>\n      <path d=\"M 18.109375 8.203125 \nL 18.109375 -20.796875 \nL 9.078125 -20.796875 \nL 9.078125 54.6875 \nL 18.109375 54.6875 \nL 18.109375 46.390625 \nQ 20.953125 51.265625 25.265625 53.625 \nQ 29.59375 56 35.59375 56 \nQ 45.5625 56 51.78125 48.09375 \nQ 58.015625 40.1875 58.015625 27.296875 \nQ 58.015625 14.40625 51.78125 6.484375 \nQ 45.5625 -1.421875 35.59375 -1.421875 \nQ 29.59375 -1.421875 25.265625 0.953125 \nQ 20.953125 3.328125 18.109375 8.203125 \nz\nM 48.6875 27.296875 \nQ 48.6875 37.203125 44.609375 42.84375 \nQ 40.53125 48.484375 33.40625 48.484375 \nQ 26.265625 48.484375 22.1875 42.84375 \nQ 18.109375 37.203125 18.109375 27.296875 \nQ 18.109375 17.390625 22.1875 11.75 \nQ 26.265625 6.109375 33.40625 6.109375 \nQ 40.53125 6.109375 44.609375 11.75 \nQ 48.6875 17.390625 48.6875 27.296875 \nz\n\" id=\"DejaVuSans-70\"/>\n      <path d=\"M 30.609375 48.390625 \nQ 23.390625 48.390625 19.1875 42.75 \nQ 14.984375 37.109375 14.984375 27.296875 \nQ 14.984375 17.484375 19.15625 11.84375 \nQ 23.34375 6.203125 30.609375 6.203125 \nQ 37.796875 6.203125 41.984375 11.859375 \nQ 46.1875 17.53125 46.1875 27.296875 \nQ 46.1875 37.015625 41.984375 42.703125 \nQ 37.796875 48.390625 30.609375 48.390625 \nz\nM 30.609375 56 \nQ 42.328125 56 49.015625 48.375 \nQ 55.71875 40.765625 55.71875 27.296875 \nQ 55.71875 13.875 49.015625 6.21875 \nQ 42.328125 -1.421875 30.609375 -1.421875 \nQ 18.84375 -1.421875 12.171875 6.21875 \nQ 5.515625 13.875 5.515625 27.296875 \nQ 5.515625 40.765625 12.171875 48.375 \nQ 18.84375 56 30.609375 56 \nz\n\" id=\"DejaVuSans-6f\"/>\n      <path d=\"M 48.78125 52.59375 \nL 48.78125 44.1875 \nQ 44.96875 46.296875 41.140625 47.34375 \nQ 37.3125 48.390625 33.40625 48.390625 \nQ 24.65625 48.390625 19.8125 42.84375 \nQ 14.984375 37.3125 14.984375 27.296875 \nQ 14.984375 17.28125 19.8125 11.734375 \nQ 24.65625 6.203125 33.40625 6.203125 \nQ 37.3125 6.203125 41.140625 7.25 \nQ 44.96875 8.296875 48.78125 10.40625 \nL 48.78125 2.09375 \nQ 45.015625 0.34375 40.984375 -0.53125 \nQ 36.96875 -1.421875 32.421875 -1.421875 \nQ 20.0625 -1.421875 12.78125 6.34375 \nQ 5.515625 14.109375 5.515625 27.296875 \nQ 5.515625 40.671875 12.859375 48.328125 \nQ 20.21875 56 33.015625 56 \nQ 37.15625 56 41.109375 55.140625 \nQ 45.0625 54.296875 48.78125 52.59375 \nz\n\" id=\"DejaVuSans-63\"/>\n      <path d=\"M 54.890625 33.015625 \nL 54.890625 0 \nL 45.90625 0 \nL 45.90625 32.71875 \nQ 45.90625 40.484375 42.875 44.328125 \nQ 39.84375 48.1875 33.796875 48.1875 \nQ 26.515625 48.1875 22.3125 43.546875 \nQ 18.109375 38.921875 18.109375 30.90625 \nL 18.109375 0 \nL 9.078125 0 \nL 9.078125 75.984375 \nL 18.109375 75.984375 \nL 18.109375 46.1875 \nQ 21.34375 51.125 25.703125 53.5625 \nQ 30.078125 56 35.796875 56 \nQ 45.21875 56 50.046875 50.171875 \nQ 54.890625 44.34375 54.890625 33.015625 \nz\n\" id=\"DejaVuSans-68\"/>\n     </defs>\n     <g transform=\"translate(132.565625 174.876562)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-65\"/>\n      <use x=\"61.523438\" xlink:href=\"#DejaVuSans-70\"/>\n      <use x=\"125\" xlink:href=\"#DejaVuSans-6f\"/>\n      <use x=\"186.181641\" xlink:href=\"#DejaVuSans-63\"/>\n      <use x=\"241.162109\" xlink:href=\"#DejaVuSans-68\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"matplotlib.axis_2\">\n    <g id=\"ytick_1\">\n     <g id=\"line2d_6\">\n      <defs>\n       <path d=\"M 0 0 \nL -3.5 0 \n\" id=\"mccaf650b85\" style=\"stroke:#000000;stroke-width:0.8;\"/>\n      </defs>\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#mccaf650b85\" y=\"144.647941\"/>\n      </g>\n     </g>\n     <g id=\"text_7\">\n      <!-- 0.25 -->\n      <g transform=\"translate(20.878125 148.447159)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-32\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-35\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_2\">\n     <g id=\"line2d_7\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#mccaf650b85\" y=\"119.318195\"/>\n      </g>\n     </g>\n     <g id=\"text_8\">\n      <!-- 0.30 -->\n      <defs>\n       <path d=\"M 40.578125 39.3125 \nQ 47.65625 37.796875 51.625 33 \nQ 55.609375 28.21875 55.609375 21.1875 \nQ 55.609375 10.40625 48.1875 4.484375 \nQ 40.765625 -1.421875 27.09375 -1.421875 \nQ 22.515625 -1.421875 17.65625 -0.515625 \nQ 12.796875 0.390625 7.625 2.203125 \nL 7.625 11.71875 \nQ 11.71875 9.328125 16.59375 8.109375 \nQ 21.484375 6.890625 26.8125 6.890625 \nQ 36.078125 6.890625 40.9375 10.546875 \nQ 45.796875 14.203125 45.796875 21.1875 \nQ 45.796875 27.640625 41.28125 31.265625 \nQ 36.765625 34.90625 28.71875 34.90625 \nL 20.21875 34.90625 \nL 20.21875 43.015625 \nL 29.109375 43.015625 \nQ 36.375 43.015625 40.234375 45.921875 \nQ 44.09375 48.828125 44.09375 54.296875 \nQ 44.09375 59.90625 40.109375 62.90625 \nQ 36.140625 65.921875 28.71875 65.921875 \nQ 24.65625 65.921875 20.015625 65.03125 \nQ 15.375 64.15625 9.8125 62.3125 \nL 9.8125 71.09375 \nQ 15.4375 72.65625 20.34375 73.4375 \nQ 25.25 74.21875 29.59375 74.21875 \nQ 40.828125 74.21875 47.359375 69.109375 \nQ 53.90625 64.015625 53.90625 55.328125 \nQ 53.90625 49.265625 50.4375 45.09375 \nQ 46.96875 40.921875 40.578125 39.3125 \nz\n\" id=\"DejaVuSans-33\"/>\n      </defs>\n      <g transform=\"translate(20.878125 123.117414)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-33\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_3\">\n     <g id=\"line2d_8\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#mccaf650b85\" y=\"93.98845\"/>\n      </g>\n     </g>\n     <g id=\"text_9\">\n      <!-- 0.35 -->\n      <g transform=\"translate(20.878125 97.787669)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-33\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-35\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_4\">\n     <g id=\"line2d_9\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#mccaf650b85\" y=\"68.658704\"/>\n      </g>\n     </g>\n     <g id=\"text_10\">\n      <!-- 0.40 -->\n      <defs>\n       <path d=\"M 37.796875 64.3125 \nL 12.890625 25.390625 \nL 37.796875 25.390625 \nz\nM 35.203125 72.90625 \nL 47.609375 72.90625 \nL 47.609375 25.390625 \nL 58.015625 25.390625 \nL 58.015625 17.1875 \nL 47.609375 17.1875 \nL 47.609375 0 \nL 37.796875 0 \nL 37.796875 17.1875 \nL 4.890625 17.1875 \nL 4.890625 26.703125 \nz\n\" id=\"DejaVuSans-34\"/>\n      </defs>\n      <g transform=\"translate(20.878125 72.457923)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-34\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_5\">\n     <g id=\"line2d_10\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#mccaf650b85\" y=\"43.328959\"/>\n      </g>\n     </g>\n     <g id=\"text_11\">\n      <!-- 0.45 -->\n      <g transform=\"translate(20.878125 47.128178)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-34\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-35\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"ytick_6\">\n     <g id=\"line2d_11\">\n      <g>\n       <use style=\"stroke:#000000;stroke-width:0.8;\" x=\"50.14375\" xlink:href=\"#mccaf650b85\" y=\"17.999213\"/>\n      </g>\n     </g>\n     <g id=\"text_12\">\n      <!-- 0.50 -->\n      <g transform=\"translate(20.878125 21.798432)scale(0.1 -0.1)\">\n       <use xlink:href=\"#DejaVuSans-30\"/>\n       <use x=\"63.623047\" xlink:href=\"#DejaVuSans-2e\"/>\n       <use x=\"95.410156\" xlink:href=\"#DejaVuSans-35\"/>\n       <use x=\"159.033203\" xlink:href=\"#DejaVuSans-30\"/>\n      </g>\n     </g>\n    </g>\n    <g id=\"text_13\">\n     <!-- loss -->\n     <defs>\n      <path d=\"M 9.421875 75.984375 \nL 18.40625 75.984375 \nL 18.40625 0 \nL 9.421875 0 \nz\n\" id=\"DejaVuSans-6c\"/>\n      <path d=\"M 44.28125 53.078125 \nL 44.28125 44.578125 \nQ 40.484375 46.53125 36.375 47.5 \nQ 32.28125 48.484375 27.875 48.484375 \nQ 21.1875 48.484375 17.84375 46.4375 \nQ 14.5 44.390625 14.5 40.28125 \nQ 14.5 37.15625 16.890625 35.375 \nQ 19.28125 33.59375 26.515625 31.984375 \nL 29.59375 31.296875 \nQ 39.15625 29.25 43.1875 25.515625 \nQ 47.21875 21.78125 47.21875 15.09375 \nQ 47.21875 7.46875 41.1875 3.015625 \nQ 35.15625 -1.421875 24.609375 -1.421875 \nQ 20.21875 -1.421875 15.453125 -0.5625 \nQ 10.6875 0.296875 5.421875 2 \nL 5.421875 11.28125 \nQ 10.40625 8.6875 15.234375 7.390625 \nQ 20.0625 6.109375 24.8125 6.109375 \nQ 31.15625 6.109375 34.5625 8.28125 \nQ 37.984375 10.453125 37.984375 14.40625 \nQ 37.984375 18.0625 35.515625 20.015625 \nQ 33.0625 21.96875 24.703125 23.78125 \nL 21.578125 24.515625 \nQ 13.234375 26.265625 9.515625 29.90625 \nQ 5.8125 33.546875 5.8125 39.890625 \nQ 5.8125 47.609375 11.28125 51.796875 \nQ 16.75 56 26.8125 56 \nQ 31.78125 56 36.171875 55.265625 \nQ 40.578125 54.546875 44.28125 53.078125 \nz\n\" id=\"DejaVuSans-73\"/>\n     </defs>\n     <g transform=\"translate(14.798437 88.307812)rotate(-90)scale(0.1 -0.1)\">\n      <use xlink:href=\"#DejaVuSans-6c\"/>\n      <use x=\"27.783203\" xlink:href=\"#DejaVuSans-6f\"/>\n      <use x=\"88.964844\" xlink:href=\"#DejaVuSans-73\"/>\n      <use x=\"141.064453\" xlink:href=\"#DejaVuSans-73\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"line2d_12\">\n    <path clip-path=\"url(#p39b7544184)\" d=\"M 59.021023 16.877273 \nL 64.939205 38.889047 \nL 70.857386 69.487611 \nL 76.775568 91.472813 \nL 82.69375 106.561338 \nL 88.611932 118.181634 \nL 94.530114 125.015821 \nL 100.448295 130.104729 \nL 106.366477 133.982847 \nL 112.284659 136.424795 \nL 118.202841 137.797508 \nL 124.121023 139.069414 \nL 130.039205 138.406746 \nL 135.957386 138.710542 \nL 141.875568 139.861229 \nL 147.79375 140.05928 \nL 153.711932 140.063342 \nL 159.630114 140.422727 \nL 165.548295 140.352674 \nL 171.466477 140.080976 \nL 177.384659 140.253935 \nL 183.302841 140.298201 \nL 189.221023 140.288705 \nL 195.139205 139.753431 \nL 201.057386 139.376758 \nL 206.975568 139.419621 \nL 212.89375 139.966082 \nL 218.811932 140.031787 \nL 224.730114 139.894489 \nL 230.648295 139.523357 \nL 236.566477 139.559199 \n\" style=\"fill:none;stroke:#1f77b4;stroke-linecap:square;stroke-width:1.5;\"/>\n   </g>\n   <g id=\"patch_3\">\n    <path d=\"M 50.14375 146.6 \nL 50.14375 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_4\">\n    <path d=\"M 245.44375 146.6 \nL 245.44375 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_5\">\n    <path d=\"M 50.14375 146.6 \nL 245.44375 146.6 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n   <g id=\"patch_6\">\n    <path d=\"M 50.14375 10.7 \nL 245.44375 10.7 \n\" style=\"fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;\"/>\n   </g>\n  </g>\n </g>\n <defs>\n  <clipPath id=\"p39b7544184\">\n   <rect height=\"135.9\" width=\"195.3\" x=\"50.14375\" y=\"10.7\"/>\n  </clipPath>\n </defs>\n</svg>\n",
   "text/plain": "<Figure size 252x180 with 1 Axes>"
  },
  "metadata": {},
  "output_type": "display_data"
 }
]
```

## 使用Gluon的实现

在Gluon中，只需要在随机梯度下降的训练器中通过`momentum`来指定动量超参数即可得到动量法。

```{.python .input  n=9}
gb.train_gluon_ch7('sgd', {'learning_rate': 0.02, 'momentum': 0.5},
                   features, labels)
```

## 小结

* 动量法使用了指数加权移动平均的思想，其将过去时刻的梯度做了加权平均，且权重按时间指数衰减。
* 动量法使得相邻时间步之间的自变量更新在方向更加一致。

## 练习

* 使用其他动量超参数和学习率的组合，观察实验结果。


## 扫码直达[讨论区](https://discuss.gluon.ai/t/topic/1879)


![](../img/qr_momentum.svg)
